if(typeof self==="undefined"){self={}}if(typeof window==="undefined"){window=self}(function(){var t,e,i;(function(r){var n,s,o,l,a={},h={},u={},p={},f=Object.prototype.hasOwnProperty,d=[].slice,v=/\.js$/;function c(t,e){return f.call(t,e)}function P(t,e){var i,r,n,s,o,l,a,h,p,f,d,c,P=e&&e.split("/"),m=u.map,y=m&&m["*"]||{};if(t){t=t.split("/");o=t.length-1;if(u.nodeIdCompat&&v.test(t[o])){t[o]=t[o].replace(v,"")}if(t[0].charAt(0)==="."&&P){c=P.slice(0,P.length-1);t=c.concat(t)}for(p=0;p<t.length;p++){d=t[p];if(d==="."){t.splice(p,1);p-=1}else if(d===".."){if(p===0||p===1&&t[2]===".."||t[p-1]===".."){continue}else if(p>0){t.splice(p-1,2);p-=2}}}t=t.join("/")}if((P||y)&&m){i=t.split("/");for(p=i.length;p>0;p-=1){r=i.slice(0,p).join("/");if(P){for(f=P.length;f>0;f-=1){n=m[P.slice(0,f).join("/")];if(n){n=n[r];if(n){s=n;l=p;break}}}}if(s){break}if(!a&&y&&y[r]){a=y[r];h=p}}if(!s&&a){s=a;l=h}if(s){i.splice(0,l,s);t=i.join("/")}}return t}function m(t,e){return function(){var i=d.call(arguments,0);if(typeof i[0]!=="string"&&i.length===1){i.push(null)}return s.apply(r,i.concat([t,e]))}}function y(t){return function(e){return P(e,t)}}function g(t){return function(e){a[t]=e}}function C(t){if(c(h,t)){var e=h[t];delete h[t];p[t]=true;n.apply(r,e)}if(!c(a,t)&&!c(p,t)){throw new Error("No "+t)}return a[t]}function x(t){var e,i=t?t.indexOf("!"):-1;if(i>-1){e=t.substring(0,i);t=t.substring(i+1,t.length)}return[e,t]}function _(t){return t?x(t):[]}o=function(t,e){var i,r=x(t),n=r[0],s=e[1];t=r[1];if(n){n=P(n,s);i=C(n)}if(n){if(i&&i.normalize){t=i.normalize(t,y(s))}else{t=P(t,s)}}else{t=P(t,s);r=x(t);n=r[0];t=r[1];if(n){i=C(n)}}return{f:n?n+"!"+t:t,n:t,pr:n,p:i}};function I(t){return function(){return u&&u.config&&u.config[t]||{}}}l={require:function(t){return m(t)},exports:function(t){var e=a[t];if(typeof e!=="undefined"){return e}else{return a[t]={}}},module:function(t){return{id:t,uri:"",exports:a[t],config:I(t)}}};n=function(t,e,i,n){var s,u,f,d,v,P,y=[],x=typeof i,I;n=n||t;P=_(n);if(x==="undefined"||x==="function"){e=!e.length&&i.length?["require","exports","module"]:e;for(v=0;v<e.length;v+=1){d=o(e[v],P);u=d.f;if(u==="require"){y[v]=l.require(t)}else if(u==="exports"){y[v]=l.exports(t);I=true}else if(u==="module"){s=y[v]=l.module(t)}else if(c(a,u)||c(h,u)||c(p,u)){y[v]=C(u)}else if(d.p){d.p.load(d.n,m(n,true),g(u),{});y[v]=a[u]}else{throw new Error(t+" missing "+u)}}f=i?i.apply(a[t],y):undefined;if(t){if(s&&s.exports!==r&&s.exports!==a[t]){a[t]=s.exports}else if(f!==r||!I){a[t]=f}}}else if(t){a[t]=i}};t=e=s=function(t,e,i,a,h){if(typeof t==="string"){if(l[t]){return l[t](e)}return C(o(t,_(e)).f)}else if(!t.splice){u=t;if(u.deps){s(u.deps,u.callback)}if(!e){return}if(e.splice){t=e;e=i;i=null}else{t=r}}e=e||function(){};if(typeof i==="function"){i=a;a=h}if(a){n(r,t,e,i)}else{setTimeout(function(){n(r,t,e,i)},4)}return s};s.config=function(t){return s(t)};t._defined=a;i=function(t,e,i){if(typeof t!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!e.splice){i=e;e=[]}if(!c(a,t)&&!c(h,t)){h[t]=[t,e,i]}};i.amd={jQuery:true}})();i("Util/defined",[],function(){"use strict";function t(t){return t!==undefined&&t!==null}return t});i("Util/defineProperties",["Util/defined"],function(t){var e=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(t){return false}}();var i=Object.defineProperties;if(!e||!t(i)){i=function(t){return t}}return i});i("Util/CanvasWorker/ImageData",["Util/defineProperties"],function(t){function e(t,e,i){if(!i){i=new Uint8ClampedArray(t*e*4)}this._data=i;this._width=t;this._height=e}t(e.prototype,{data:{get:function(){return this._data}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}});return e});i("Util/CanvasWorker/Error",[],function(){function t(t){this.name=t}t.prototype.syntaxError=function(t,e){throw"Uncaught SyntaxError: Failed to execute "+t+" on "+this.name+": +error}."};t.prototype.typeError=function(t,e){throw"Uncaught TypeError: Failed to execute "+t+" on "+this.name+": +error}."};t.prototype.argumetsCheck=function(t,e,i){if(i<e){this.typeError(t,e+"arguments required, but only "+i+" present")}};return t});i("Util/CanvasWorker/Color",["Util/defined","Util/defineProperties"],function(t,e){function i(t){this.r=0;this.g=0;this.b=0;this.a=0;if(t)this.str=t;else this._str=""}e(i.prototype,{str:{set:function(t){this._str=t;if(t.startsWith("#")){this.r=parseInt(t.slice(1,3),16);this.g=parseInt(t.slice(3,5),16);this.b=parseInt(t.slice(5,7),16);this.a=1}else if(t.startsWith("rgba")){var e=t.indexOf("(")+1;var i=t.indexOf(")");var r=t.slice(e,i).split(",").map(parseFloat);var n=r[0],s=r[1],o=r[2],l=r[3];this.r=n;this.g=s;this.b=o;this.a=l}else if(t.startsWith("rgb")){var e=t.indexOf("(")+1;var i=t.indexOf(")");var r=t.slice(e,i).split(",").map(parseFloat);var n=r[0],s=r[1],o=r[2];this.r=n;this.g=s;this.b=o;this.a=1}else{}},get:function(){return this._str}}});i.prototype.getPixel=function(){return this};i.prototype.set=function(t,e,i,r){this.r=t;this.g=e;this.b=i;this.a=r;return this};i.prototype.copy=function(t,e,i,r){return{r:t,g:e,b:i,a:r}};i.prototype.sourceOver=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(l+r*(1-l),1);var h=(n*l+r*t*(1-l))/a;var u=(s*l+r*e*(1-l))/a;var p=(o*l+r*i*(1-l))/a;return{r:h,g:u,b:p,a:a}};i.prototype.destinationOver=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(l*(1-r)+a,1);var h=(l*n*(1-r)+r*t)/a;var u=(l*s*(1-r)+r*e)/a;var p=(l*o*(1-r)+r*i)/a;return{r:h,g:u,b:p,a:a}};i.prototype.sourceIn=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(l*r,1);var h=n*r*l/a;var u=s*r*l/a;var p=o*r*l/a;return{r:h,g:u,b:p,a:a}};i.prototype.destinationIn=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(l*r,1);var h=t*r*l/a;var u=e*r*l/a;var p=i*r*l/a;return{r:h,g:u,b:p,a:a}};i.prototype.sourceOut=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(l*(1-r),1);var h=l*n*(1-r)/a;var u=l*s*(1-r)/a;var p=l*o*(1-r)/a;return{r:h,g:u,b:p,a:a}};i.prototype.destinationOut=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(r*(1-l),1);var h=r*t*(1-l)/a;var u=r*e*(1-l)/a;var p=r*i*(1-l)/a;return{r:h,g:u,b:p,a:a}};i.prototype.sourceAtop=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(r*l+r*(1-l),1);var h=(l*n*r+r*t*(1-l))/a;var u=(l*s*r+r*e*(1-l))/a;var p=(l*o*r+r*i*(1-l))/a;return{r:h,g:u,b:p,a:a}};i.prototype.destinationAtop=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(r*l+l*(1-r),1);var h=(r*t*l+l*n*(1-r))/a;var u=(r*e*l+l*s*(1-r))/a;var p=(r*i*l+l*o*(1-r))/a;return{r:h,g:u,b:p,a:a}};i.prototype.xOr=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(l*(1-r)+r*(1-l),1);var h=(l*n*(1-r)+r*t*(1-l))/a;var u=(l*s*(1-r)+r*e*(1-l))/a;var p=(l*o*(1-r)+r*i*(1-l))/a;return{r:h,g:u,b:p,a:a}};i.prototype.lighter=function(t,e,i,r){var n=this.r;var s=this.g;var o=this.b;var l=this.a;var a=Math.min(l+r,1);var h=(l*n+r*t)/a;var u=(l*s+r*e)/a;var p=(l*o+r*i)/a;return{r:h,g:u,b:p,a:a}};return i});i("Util/CanvasWorker/CanvasPattern",["./Color"],function(t){var e=new t;function i(t,e){this._image=t;this._repeat=e}i.prototype.getPixel=function(t,i){t=Math.round(this._repeat==="repeat"||this._repeat==="repeat-x"?t%this._image.width:t);i=Math.round(this._repeat==="repeat"||this._repeat==="repeat-y"?i%this._image.height:i);if(t>=0&&i>=0&&t<this._image.width&&i<this._image.height){var r=i*this._image.width+t;var n=this._image.imageData.r[r];var s=this._image.imageData.g[r];var o=this._image.imageData.b[r];var l=this._image.imageData.a[r];return e.set(n,s,o,l)}else{return e.set(0,0,0,0)}};return i});(function(t){"use strict";var e=false;var r=false;var n=true;var s=false;var o={};var l=false;if(typeof module!=="undefined"&&module.exports){module.exports=o;l=true}else{if(typeof i==="function"&&i.amd){i("ThirdParty/clipper-lib/clipper",o)}else{t["ClipperLib"]=o}}var a;if(!l){var h=navigator.userAgent.toString().toLowerCase();a=navigator.appName}else{var h="chrome";a="Netscape"}var u={};if(h.indexOf("chrome")!=-1&&h.indexOf("chromium")==-1)u.chrome=1;else u.chrome=0;if(h.indexOf("chromium")!=-1)u.chromium=1;else u.chromium=0;if(h.indexOf("safari")!=-1&&h.indexOf("chrome")==-1&&h.indexOf("chromium")==-1)u.safari=1;else u.safari=0;if(h.indexOf("firefox")!=-1)u.firefox=1;else u.firefox=0;if(h.indexOf("firefox/17")!=-1)u.firefox17=1;else u.firefox17=0;if(h.indexOf("firefox/15")!=-1)u.firefox15=1;else u.firefox15=0;if(h.indexOf("firefox/3")!=-1)u.firefox3=1;else u.firefox3=0;if(h.indexOf("opera")!=-1)u.opera=1;else u.opera=0;if(h.indexOf("msie 10")!=-1)u.msie10=1;else u.msie10=0;if(h.indexOf("msie 9")!=-1)u.msie9=1;else u.msie9=0;if(h.indexOf("msie 8")!=-1)u.msie8=1;else u.msie8=0;if(h.indexOf("msie 7")!=-1)u.msie7=1;else u.msie7=0;if(h.indexOf("msie ")!=-1)u.msie=1;else u.msie=0;o.biginteger_used=null;var p;var f=0xdeadbeefcafe;var d=(f&16777215)==15715070;function v(t,e,i){o.biginteger_used=1;if(t!=null)if("number"==typeof t&&"undefined"==typeof e)this.fromInt(t);else if("number"==typeof t)this.fromNumber(t,e,i);else if(e==null&&"string"!=typeof t)this.fromString(t,256);else this.fromString(t,e)}function c(){return new v(null)}function P(t,e,i,r,n,s){while(--s>=0){var o=e*this[t++]+i[r]+n;n=Math.floor(o/67108864);i[r++]=o&67108863}return n}function m(t,e,i,r,n,s){var o=e&32767,l=e>>15;while(--s>=0){var a=this[t]&32767;var h=this[t++]>>15;var u=l*a+h*o;a=o*a+((u&32767)<<15)+i[r]+(n&1073741823);n=(a>>>30)+(u>>>15)+l*h+(n>>>30);i[r++]=a&1073741823}return n}function y(t,e,i,r,n,s){var o=e&16383,l=e>>14;while(--s>=0){var a=this[t]&16383;var h=this[t++]>>14;var u=l*a+h*o;a=o*a+((u&16383)<<14)+i[r]+n;n=(a>>28)+(u>>14)+l*h;i[r++]=a&268435455}return n}if(d&&a=="Microsoft Internet Explorer"){v.prototype.am=m;p=30}else if(d&&a!="Netscape"){v.prototype.am=P;p=26}else{v.prototype.am=y;p=28}v.prototype.DB=p;v.prototype.DM=(1<<p)-1;v.prototype.DV=1<<p;var g=52;v.prototype.FV=Math.pow(2,g);v.prototype.F1=g-p;v.prototype.F2=2*p-g;var C="0123456789abcdefghijklmnopqrstuvwxyz";var x=new Array;var _,I;_="0".charCodeAt(0);for(I=0;I<=9;++I)x[_++]=I;_="a".charCodeAt(0);for(I=10;I<36;++I)x[_++]=I;_="A".charCodeAt(0);for(I=10;I<36;++I)x[_++]=I;function E(t){return C.charAt(t)}function T(t,e){var i=x[t.charCodeAt(e)];return i==null?-1:i}function L(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t;t.s=this.s}function X(t){this.t=1;this.s=t<0?-1:0;if(t>0)this[0]=t;else if(t<-1)this[0]=t+this.DV;else this.t=0}function w(t){var e=c();e.fromInt(t);return e}function O(t,e){var i;if(e==16)i=4;else if(e==8)i=3;else if(e==256)i=8;else if(e==2)i=1;else if(e==32)i=5;else if(e==4)i=2;else{this.fromRadix(t,e);return}this.t=0;this.s=0;var r=t.length,n=false,s=0;while(--r>=0){var o=i==8?t[r]&255:T(t,r);if(o<0){if(t.charAt(r)=="-")n=true;continue}n=false;if(s==0)this[this.t++]=o;else if(s+i>this.DB){this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s;this[this.t++]=o>>this.DB-s}else this[this.t-1]|=o<<s;s+=i;if(s>=this.DB)s-=this.DB}if(i==8&&(t[0]&128)!=0){this.s=-1;if(s>0)this[this.t-1]|=(1<<this.DB-s)-1<<s}this.clamp();if(n)v.ZERO.subTo(this,this)}function Y(){var t=this.s&this.DM;while(this.t>0&&this[this.t-1]==t)--this.t}function S(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var i=(1<<e)-1,r,n=false,s="",o=this.t;var l=this.DB-o*this.DB%e;if(o-- >0){if(l<this.DB&&(r=this[o]>>l)>0){n=true;s=E(r)}while(o>=0){if(l<e){r=(this[o]&(1<<l)-1)<<e-l;r|=this[--o]>>(l+=this.DB-e)}else{r=this[o]>>(l-=e)&i;if(l<=0){l+=this.DB;--o}}if(r>0)n=true;if(n)s+=E(r)}}return n?s:"0"}function N(){var t=c();v.ZERO.subTo(this,t);return t}function A(){return this.s<0?this.negate():this}function D(t){var e=this.s-t.s;if(e!=0)return e;var i=this.t;e=i-t.t;if(e!=0)return this.s<0?-e:e;while(--i>=0)if((e=this[i]-t[i])!=0)return e;return 0}function b(t){var e=1,i;if((i=t>>>16)!=0){t=i;e+=16}if((i=t>>8)!=0){t=i;e+=8}if((i=t>>4)!=0){t=i;e+=4}if((i=t>>2)!=0){t=i;e+=2}if((i=t>>1)!=0){t=i;e+=1}return e}function B(){if(this.t<=0)return 0;return this.DB*(this.t-1)+b(this[this.t-1]^this.s&this.DM)}function M(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t;e.s=this.s}function R(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0);e.s=this.s}function F(t,e){var i=t%this.DB;var r=this.DB-i;var n=(1<<r)-1;var s=Math.floor(t/this.DB),o=this.s<<i&this.DM,l;for(l=this.t-1;l>=0;--l){e[l+s+1]=this[l]>>r|o;o=(this[l]&n)<<i}for(l=s-1;l>=0;--l)e[l]=0;e[s]=o;e.t=this.t+s+1;e.s=this.s;e.clamp()}function W(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t){e.t=0;return}var r=t%this.DB;var n=this.DB-r;var s=(1<<r)-1;e[0]=this[i]>>r;for(var o=i+1;o<this.t;++o){e[o-i-1]|=(this[o]&s)<<n;e[o-i]=this[o]>>r}if(r>0)e[this.t-i-1]|=(this.s&s)<<n;e.t=this.t-i;e.clamp()}function k(t,e){var i=0,r=0,n=Math.min(t.t,this.t);while(i<n){r+=this[i]-t[i];e[i++]=r&this.DM;r>>=this.DB}if(t.t<this.t){r-=t.s;while(i<this.t){r+=this[i];e[i++]=r&this.DM;r>>=this.DB}r+=this.s}else{r+=this.s;while(i<t.t){r-=t[i];e[i++]=r&this.DM;r>>=this.DB}r-=t.s}e.s=r<0?-1:0;if(r<-1)e[i++]=this.DV+r;else if(r>0)e[i++]=r;e.t=i;e.clamp()}function q(t,e){var i=this.abs(),r=t.abs();var n=i.t;e.t=n+r.t;while(--n>=0)e[n]=0;for(n=0;n<r.t;++n)e[n+i.t]=i.am(0,r[n],e,n,0,i.t);e.s=0;e.clamp();if(this.s!=t.s)v.ZERO.subTo(e,e)}function U(t){var e=this.abs();var i=t.t=2*e.t;while(--i>=0)t[i]=0;for(i=0;i<e.t-1;++i){var r=e.am(i,e[i],t,2*i,0,1);if((t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,r,e.t-i-1))>=e.DV){t[i+e.t]-=e.DV;t[i+e.t+1]=1}}if(t.t>0)t[t.t-1]+=e.am(i,e[i],t,2*i,0,1);t.s=0;t.clamp()}function j(t,e,i){var r=t.abs();if(r.t<=0)return;var n=this.abs();if(n.t<r.t){if(e!=null)e.fromInt(0);if(i!=null)this.copyTo(i);return}if(i==null)i=c();var s=c(),o=this.s,l=t.s;var a=this.DB-b(r[r.t-1]);if(a>0){r.lShiftTo(a,s);n.lShiftTo(a,i)}else{r.copyTo(s);n.copyTo(i)}var h=s.t;var u=s[h-1];if(u==0)return;var p=u*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0);var f=this.FV/p,d=(1<<this.F1)/p,P=1<<this.F2;var m=i.t,y=m-h,g=e==null?c():e;s.dlShiftTo(y,g);if(i.compareTo(g)>=0){i[i.t++]=1;i.subTo(g,i)}v.ONE.dlShiftTo(h,g);g.subTo(s,s);while(s.t<h)s[s.t++]=0;while(--y>=0){var C=i[--m]==u?this.DM:Math.floor(i[m]*f+(i[m-1]+P)*d);if((i[m]+=s.am(0,C,i,y,0,h))<C){s.dlShiftTo(y,g);i.subTo(g,i);while(i[m]<--C)i.subTo(g,i)}}if(e!=null){i.drShiftTo(h,e);if(o!=l)v.ZERO.subTo(e,e)}i.t=h;i.clamp();if(a>0)i.rShiftTo(a,i);if(o<0)v.ZERO.subTo(i,i)}function H(t){var e=c();this.abs().divRemTo(t,null,e);if(this.s<0&&e.compareTo(v.ZERO)>0)t.subTo(e,e);return e}function J(t){this.m=t}function z(t){if(t.s<0||t.compareTo(this.m)>=0)return t.mod(this.m);else return t}function G(t){return t}function Z(t){t.divRemTo(this.m,null,t)}function V(t,e,i){t.multiplyTo(e,i);this.reduce(i)}function $(t,e){t.squareTo(e);this.reduce(e)}J.prototype.convert=z;J.prototype.revert=G;J.prototype.reduce=Z;J.prototype.mulTo=V;J.prototype.sqrTo=$;function Q(){if(this.t<1)return 0;var t=this[0];if((t&1)==0)return 0;var e=t&3;e=e*(2-(t&15)*e)&15;e=e*(2-(t&255)*e)&255;e=e*(2-((t&65535)*e&65535))&65535;e=e*(2-t*e%this.DV)%this.DV;return e>0?this.DV-e:-e}function K(t){this.m=t;this.mp=t.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<t.DB-15)-1;this.mt2=2*t.t}function tt(t){var e=c();t.abs().dlShiftTo(this.m.t,e);e.divRemTo(this.m,null,e);if(t.s<0&&e.compareTo(v.ZERO)>0)this.m.subTo(e,e);return e}function et(t){var e=c();t.copyTo(e);this.reduce(e);return e}function it(t){while(t.t<=this.mt2)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=t[e]&32767;var r=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;i=e+this.m.t;t[i]+=this.m.am(0,r,t,e,0,this.m.t);while(t[i]>=t.DV){t[i]-=t.DV;t[++i]++}}t.clamp();t.drShiftTo(this.m.t,t);if(t.compareTo(this.m)>=0)t.subTo(this.m,t)}function rt(t,e){t.squareTo(e);this.reduce(e)}function nt(t,e,i){t.multiplyTo(e,i);this.reduce(i)}K.prototype.convert=tt;K.prototype.revert=et;K.prototype.reduce=it;K.prototype.mulTo=nt;K.prototype.sqrTo=rt;function st(){return(this.t>0?this[0]&1:this.s)==0}function ot(t,e){if(t>4294967295||t<1)return v.ONE;var i=c(),r=c(),n=e.convert(this),s=b(t)-1;n.copyTo(i);while(--s>=0){e.sqrTo(i,r);if((t&1<<s)>0)e.mulTo(r,n,i);else{var o=i;i=r;r=o}}return e.revert(i)}function lt(t,e){var i;if(t<256||e.isEven())i=new J(e);else i=new K(e);return this.exp(t,i)}v.prototype.copyTo=L;v.prototype.fromInt=X;v.prototype.fromString=O;v.prototype.clamp=Y;v.prototype.dlShiftTo=M;v.prototype.drShiftTo=R;v.prototype.lShiftTo=F;v.prototype.rShiftTo=W;v.prototype.subTo=k;v.prototype.multiplyTo=q;v.prototype.squareTo=U;v.prototype.divRemTo=j;v.prototype.invDigit=Q;v.prototype.isEven=st;v.prototype.exp=ot;v.prototype.toString=S;v.prototype.negate=N;v.prototype.abs=A;v.prototype.compareTo=D;v.prototype.bitLength=B;v.prototype.mod=H;v.prototype.modPowInt=lt;v.ZERO=w(0);v.ONE=w(1);function at(){var t=c();this.copyTo(t);return t}function ht(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function ut(){return this.t==0?this.s:this[0]<<24>>24}function pt(){return this.t==0?this.s:this[0]<<16>>16}function ft(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function dt(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this[0]<=0)return 0;else return 1}function vt(t){if(t==null)t=10;if(this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t);var i=Math.pow(t,e);var r=w(i),n=c(),s=c(),o="";this.divRemTo(r,n,s);while(n.signum()>0){o=(i+s.intValue()).toString(t).substr(1)+o;n.divRemTo(r,n,s)}return s.intValue().toString(t)+o}function ct(t,e){this.fromInt(0);if(e==null)e=10;var i=this.chunkSize(e);var r=Math.pow(e,i),n=false,s=0,o=0;for(var l=0;l<t.length;++l){var a=T(t,l);if(a<0){if(t.charAt(l)=="-"&&this.signum()==0)n=true;continue}o=e*o+a;if(++s>=i){this.dMultiply(r);this.dAddOffset(o,0);s=0;o=0}}if(s>0){this.dMultiply(Math.pow(e,s));this.dAddOffset(o,0)}if(n)v.ZERO.subTo(this,this)}function Pt(t,e,i){if("number"==typeof e){if(t<2)this.fromInt(1);else{this.fromNumber(t,i);if(!this.testBit(t-1))this.bitwiseTo(v.ONE.shiftLeft(t-1),Et,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(e)){this.dAddOffset(2,0);if(this.bitLength()>t)this.subTo(v.ONE.shiftLeft(t-1),this)}}}else{var r=new Array,n=t&7;r.length=(t>>3)+1;e.nextBytes(r);if(n>0)r[0]&=(1<<n)-1;else r[0]=0;this.fromString(r,256)}}function mt(){var t=this.t,e=new Array;e[0]=this.s;var i=this.DB-t*this.DB%8,r,n=0;if(t-- >0){if(i<this.DB&&(r=this[t]>>i)!=(this.s&this.DM)>>i)e[n++]=r|this.s<<this.DB-i;while(t>=0){if(i<8){r=(this[t]&(1<<i)-1)<<8-i;r|=this[--t]>>(i+=this.DB-8)}else{r=this[t]>>(i-=8)&255;if(i<=0){i+=this.DB;--t}}if((r&128)!=0)r|=-256;if(n==0&&(this.s&128)!=(r&128))++n;if(n>0||r!=this.s)e[n++]=r}}return e}function yt(t){return this.compareTo(t)==0}function gt(t){return this.compareTo(t)<0?this:t}function Ct(t){return this.compareTo(t)>0?this:t}function xt(t,e,i){var r,n,s=Math.min(t.t,this.t);for(r=0;r<s;++r)i[r]=e(this[r],t[r]);if(t.t<this.t){n=t.s&this.DM;for(r=s;r<this.t;++r)i[r]=e(this[r],n);i.t=this.t}else{n=this.s&this.DM;for(r=s;r<t.t;++r)i[r]=e(n,t[r]);i.t=t.t}i.s=e(this.s,t.s);i.clamp()}function _t(t,e){return t&e}function It(t){var e=c();this.bitwiseTo(t,_t,e);return e}function Et(t,e){return t|e}function Tt(t){var e=c();this.bitwiseTo(t,Et,e);return e}function Lt(t,e){return t^e}function Xt(t){var e=c();this.bitwiseTo(t,Lt,e);return e}function wt(t,e){return t&~e}function Ot(t){var e=c();this.bitwiseTo(t,wt,e);return e}function Yt(){var t=c();for(var e=0;e<this.t;++e)t[e]=this.DM&~this[e];t.t=this.t;t.s=~this.s;return t}function St(t){var e=c();if(t<0)this.rShiftTo(-t,e);else this.lShiftTo(t,e);return e}function Nt(t){var e=c();if(t<0)this.lShiftTo(-t,e);else this.rShiftTo(t,e);return e}function At(t){if(t==0)return-1;var e=0;if((t&65535)==0){t>>=16;e+=16}if((t&255)==0){t>>=8;e+=8}if((t&15)==0){t>>=4;e+=4}if((t&3)==0){t>>=2;e+=2}if((t&1)==0)++e;return e}function Dt(){for(var t=0;t<this.t;++t)if(this[t]!=0)return t*this.DB+At(this[t]);if(this.s<0)return this.t*this.DB;return-1}function bt(t){var e=0;while(t!=0){t&=t-1;++e}return e}function Bt(){var t=0,e=this.s&this.DM;for(var i=0;i<this.t;++i)t+=bt(this[i]^e);return t}function Mt(t){var e=Math.floor(t/this.DB);if(e>=this.t)return this.s!=0;return(this[e]&1<<t%this.DB)!=0}function Rt(t,e){var i=v.ONE.shiftLeft(t);this.bitwiseTo(i,e,i);return i}function Ft(t){return this.changeBit(t,Et)}function Wt(t){return this.changeBit(t,wt)}function kt(t){return this.changeBit(t,Lt)}function qt(t,e){var i=0,r=0,n=Math.min(t.t,this.t);while(i<n){r+=this[i]+t[i];e[i++]=r&this.DM;r>>=this.DB}if(t.t<this.t){r+=t.s;while(i<this.t){r+=this[i];e[i++]=r&this.DM;r>>=this.DB}r+=this.s}else{r+=this.s;while(i<t.t){r+=t[i];e[i++]=r&this.DM;r>>=this.DB}r+=t.s}e.s=r<0?-1:0;if(r>0)e[i++]=r;else if(r<-1)e[i++]=this.DV+r;e.t=i;e.clamp()}function Ut(t){var e=c();this.addTo(t,e);return e}function jt(t){var e=c();this.subTo(t,e);return e}function Ht(t){var e=c();this.multiplyTo(t,e);return e}function Jt(){var t=c();this.squareTo(t);return t}function zt(t){var e=c();this.divRemTo(t,e,null);return e}function Gt(t){var e=c();this.divRemTo(t,null,e);return e}function Zt(t){var e=c(),i=c();this.divRemTo(t,e,i);return new Array(e,i)}function Vt(t){this[this.t]=this.am(0,t-1,this,0,0,this.t);++this.t;this.clamp()}function $t(t,e){if(t==0)return;while(this.t<=e)this[this.t++]=0;this[e]+=t;while(this[e]>=this.DV){this[e]-=this.DV;if(++e>=this.t)this[this.t++]=0;++this[e]}}function Qt(){}function Kt(t){return t}function te(t,e,i){t.multiplyTo(e,i)}function ee(t,e){t.squareTo(e)}Qt.prototype.convert=Kt;Qt.prototype.revert=Kt;Qt.prototype.mulTo=te;Qt.prototype.sqrTo=ee;function ie(t){return this.exp(t,new Qt)}function re(t,e,i){var r=Math.min(this.t+t.t,e);i.s=0;i.t=r;while(r>0)i[--r]=0;var n;for(n=i.t-this.t;r<n;++r)i[r+this.t]=this.am(0,t[r],i,r,0,this.t);for(n=Math.min(t.t,e);r<n;++r)this.am(0,t[r],i,r,0,e-r);i.clamp()}function ne(t,e,i){--e;var r=i.t=this.t+t.t-e;i.s=0;while(--r>=0)i[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)i[this.t+r-e]=this.am(e-r,t[r],i,0,0,this.t+r-e);i.clamp();i.drShiftTo(1,i)}function se(t){this.r2=c();this.q3=c();v.ONE.dlShiftTo(2*t.t,this.r2);this.mu=this.r2.divide(t);this.m=t}function oe(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);else if(t.compareTo(this.m)<0)return t;else{var e=c();t.copyTo(e);this.reduce(e);return e}}function le(t){return t}function ae(t){t.drShiftTo(this.m.t-1,this.r2);if(t.t>this.m.t+1){t.t=this.m.t+1;t.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(t.compareTo(this.r2)<0)t.dAddOffset(1,this.m.t+1);t.subTo(this.r2,t);while(t.compareTo(this.m)>=0)t.subTo(this.m,t)}function he(t,e){t.squareTo(e);this.reduce(e)}function ue(t,e,i){t.multiplyTo(e,i);this.reduce(i)}se.prototype.convert=oe;se.prototype.revert=le;se.prototype.reduce=ae;se.prototype.mulTo=ue;se.prototype.sqrTo=he;function pe(t,e){var i=t.bitLength(),r,n=w(1),s;if(i<=0)return n;else if(i<18)r=1;else if(i<48)r=3;else if(i<144)r=4;else if(i<768)r=5;else r=6;if(i<8)s=new J(e);else if(e.isEven())s=new se(e);else s=new K(e);var o=new Array,l=3,a=r-1,h=(1<<r)-1;o[1]=s.convert(this);if(r>1){var u=c();s.sqrTo(o[1],u);while(l<=h){o[l]=c();s.mulTo(u,o[l-2],o[l]);l+=2}}var p=t.t-1,f,d=true,v=c(),P;i=b(t[p])-1;while(p>=0){if(i>=a)f=t[p]>>i-a&h;else{f=(t[p]&(1<<i+1)-1)<<a-i;if(p>0)f|=t[p-1]>>this.DB+i-a}l=r;while((f&1)==0){f>>=1;--l}if((i-=l)<0){i+=this.DB;--p}if(d){o[f].copyTo(n);d=false}else{while(l>1){s.sqrTo(n,v);s.sqrTo(v,n);l-=2}if(l>0)s.sqrTo(n,v);else{P=n;n=v;v=P}s.mulTo(v,o[f],n)}while(p>=0&&(t[p]&1<<i)==0){s.sqrTo(n,v);P=n;n=v;v=P;if(--i<0){i=this.DB-1;--p}}}return s.revert(n)}function fe(t){var e=this.s<0?this.negate():this.clone();var i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var r=e;e=i;i=r}var n=e.getLowestSetBit(),s=i.getLowestSetBit();if(s<0)return e;if(n<s)s=n;if(s>0){e.rShiftTo(s,e);i.rShiftTo(s,i)}while(e.signum()>0){if((n=e.getLowestSetBit())>0)e.rShiftTo(n,e);if((n=i.getLowestSetBit())>0)i.rShiftTo(n,i);if(e.compareTo(i)>=0){e.subTo(i,e);e.rShiftTo(1,e)}else{i.subTo(e,i);i.rShiftTo(1,i)}}if(s>0)i.lShiftTo(s,i);return i}function de(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(e==0)i=this[0]%t;else for(var r=this.t-1;r>=0;--r)i=(e*i+this[r])%t;return i}function ve(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return v.ZERO;var i=t.clone(),r=this.clone();var n=w(1),s=w(0),o=w(0),l=w(1);while(i.signum()!=0){while(i.isEven()){i.rShiftTo(1,i);if(e){if(!n.isEven()||!s.isEven()){n.addTo(this,n);s.subTo(t,s)}n.rShiftTo(1,n)}else if(!s.isEven())s.subTo(t,s);s.rShiftTo(1,s)}while(r.isEven()){r.rShiftTo(1,r);if(e){if(!o.isEven()||!l.isEven()){o.addTo(this,o);l.subTo(t,l)}o.rShiftTo(1,o)}else if(!l.isEven())l.subTo(t,l);l.rShiftTo(1,l)}if(i.compareTo(r)>=0){i.subTo(r,i);if(e)n.subTo(o,n);s.subTo(l,s)}else{r.subTo(i,r);if(e)o.subTo(n,o);l.subTo(s,l)}}if(r.compareTo(v.ONE)!=0)return v.ZERO;if(l.compareTo(t)>=0)return l.subtract(t);if(l.signum()<0)l.addTo(t,l);else return l;if(l.signum()<0)return l.add(t);else return l}var ce=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var Pe=(1<<26)/ce[ce.length-1];function me(t){var e,i=this.abs();if(i.t==1&&i[0]<=ce[ce.length-1]){for(e=0;e<ce.length;++e)if(i[0]==ce[e])return true;return false}if(i.isEven())return false;e=1;while(e<ce.length){var r=ce[e],n=e+1;while(n<ce.length&&r<Pe)r*=ce[n++];r=i.modInt(r);while(e<n)if(r%ce[e++]==0)return false}return i.millerRabin(t)}function ye(t){var e=this.subtract(v.ONE);var i=e.getLowestSetBit();if(i<=0)return false;var r=e.shiftRight(i);t=t+1>>1;if(t>ce.length)t=ce.length;var n=c();for(var s=0;s<t;++s){n.fromInt(ce[Math.floor(Math.random()*ce.length)]);var o=n.modPow(r,this);if(o.compareTo(v.ONE)!=0&&o.compareTo(e)!=0){var l=1;while(l++<i&&o.compareTo(e)!=0){o=o.modPowInt(2,this);if(o.compareTo(v.ONE)==0)return false}if(o.compareTo(e)!=0)return false}}return true}v.prototype.chunkSize=ft;v.prototype.toRadix=vt;v.prototype.fromRadix=ct;v.prototype.fromNumber=Pt;v.prototype.bitwiseTo=xt;v.prototype.changeBit=Rt;v.prototype.addTo=qt;v.prototype.dMultiply=Vt;v.prototype.dAddOffset=$t;v.prototype.multiplyLowerTo=re;v.prototype.multiplyUpperTo=ne;v.prototype.modInt=de;v.prototype.millerRabin=ye;v.prototype.clone=at;v.prototype.intValue=ht;v.prototype.byteValue=ut;v.prototype.shortValue=pt;v.prototype.signum=dt;v.prototype.toByteArray=mt;v.prototype.equals=yt;v.prototype.min=gt;v.prototype.max=Ct;v.prototype.and=It;v.prototype.or=Tt;v.prototype.xor=Xt;v.prototype.andNot=Ot;v.prototype.not=Yt;v.prototype.shiftLeft=St;v.prototype.shiftRight=Nt;v.prototype.getLowestSetBit=Dt;v.prototype.bitCount=Bt;v.prototype.testBit=Mt;v.prototype.setBit=Ft;v.prototype.clearBit=Wt;v.prototype.flipBit=kt;v.prototype.add=Ut;v.prototype.subtract=jt;v.prototype.multiply=Ht;v.prototype.divide=zt;v.prototype.remainder=Gt;v.prototype.divideAndRemainder=Zt;v.prototype.modPow=pe;v.prototype.modInverse=ve;v.prototype.pow=ie;v.prototype.gcd=fe;v.prototype.isProbablePrime=me;v.prototype.square=Jt;var ge=v;ge.prototype.IsNegative=function(){if(this.compareTo(ge.ZERO)==-1)return true;else return false};ge.op_Equality=function(t,e){if(t.compareTo(e)==0)return true;else return false};ge.op_Inequality=function(t,e){if(t.compareTo(e)!=0)return true;else return false};ge.op_GreaterThan=function(t,e){if(t.compareTo(e)>0)return true;else return false};ge.op_LessThan=function(t,e){if(t.compareTo(e)<0)return true;else return false};ge.op_Addition=function(t,e){return new ge(t).add(new ge(e))};ge.op_Subtraction=function(t,e){return new ge(t).subtract(new ge(e))};ge.Int128Mul=function(t,e){return new ge(t).multiply(new ge(e))};ge.op_Division=function(t,e){return t.divide(e)};ge.prototype.ToDouble=function(){return parseFloat(this.toString())};if(typeof Ce=="undefined"){var Ce=function(t,e){var i;if(typeof Object.getOwnPropertyNames=="undefined"){for(i in e.prototype)if(typeof t.prototype[i]=="undefined"||t.prototype[i]==Object.prototype[i])t.prototype[i]=e.prototype[i];for(i in e)if(typeof t[i]=="undefined")t[i]=e[i];t.$baseCtor=e}else{var r=Object.getOwnPropertyNames(e.prototype);for(var n=0;n<r.length;n++)if(typeof Object.getOwnPropertyDescriptor(t.prototype,r[n])=="undefined")Object.defineProperty(t.prototype,r[n],Object.getOwnPropertyDescriptor(e.prototype,r[n]));for(i in e)if(typeof t[i]=="undefined")t[i]=e[i];t.$baseCtor=e}}}o.Path=function(){return[]};o.Paths=function(){return[]};o.DoublePoint=function(){var t=arguments;this.X=0;this.Y=0;if(t.length==1){this.X=t[0].X;this.Y=t[0].Y}else if(t.length==2){this.X=t[0];this.Y=t[1]}};o.DoublePoint0=function(){this.X=0;this.Y=0};o.DoublePoint1=function(t){this.X=t.X;this.Y=t.Y};o.DoublePoint2=function(t,e){this.X=t;this.Y=e};o.PolyNode=function(){this.m_Parent=null;this.m_polygon=new o.Path;this.m_Index=0;this.m_jointype=0;this.m_endtype=0;this.m_Childs=[];this.IsOpen=false};o.PolyNode.prototype.IsHoleNode=function(){var t=true;var e=this.m_Parent;while(e!==null){t=!t;e=e.m_Parent}return t};o.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length};o.PolyNode.prototype.Contour=function(){return this.m_polygon};o.PolyNode.prototype.AddChild=function(t){var e=this.m_Childs.length;this.m_Childs.push(t);t.m_Parent=this;t.m_Index=e};o.PolyNode.prototype.GetNext=function(){if(this.m_Childs.length>0)return this.m_Childs[0];else return this.GetNextSiblingUp()};o.PolyNode.prototype.GetNextSiblingUp=function(){if(this.m_Parent===null)return null;else if(this.m_Index==this.m_Parent.m_Childs.length-1)return this.m_Parent.GetNextSiblingUp();else return this.m_Parent.m_Childs[this.m_Index+1]};o.PolyNode.prototype.Childs=function(){return this.m_Childs};o.PolyNode.prototype.Parent=function(){return this.m_Parent};o.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};o.PolyTree=function(){this.m_AllPolys=[];o.PolyNode.call(this)};o.PolyTree.prototype.Clear=function(){for(var t=0,e=this.m_AllPolys.length;t<e;t++)this.m_AllPolys[t]=null;this.m_AllPolys.length=0;this.m_Childs.length=0};o.PolyTree.prototype.GetFirst=function(){if(this.m_Childs.length>0)return this.m_Childs[0];else return null};o.PolyTree.prototype.Total=function(){return this.m_AllPolys.length};Ce(o.PolyTree,o.PolyNode);o.Math_Abs_Int64=o.Math_Abs_Int32=o.Math_Abs_Double=function(t){return Math.abs(t)};o.Math_Max_Int32_Int32=function(t,e){return Math.max(t,e)};if(u.msie||u.opera||u.safari)o.Cast_Int32=function(t){return t|0};else o.Cast_Int32=function(t){return~~t};if(u.chrome)o.Cast_Int64=function(t){if(t<-2147483648||t>2147483647)return t<0?Math.ceil(t):Math.floor(t);else return~~t};else if(u.firefox&&typeof Number.toInteger=="function")o.Cast_Int64=function(t){return Number.toInteger(t)};else if(u.msie7||u.msie8)o.Cast_Int64=function(t){return parseInt(t,10)};else if(u.msie)o.Cast_Int64=function(t){if(t<-2147483648||t>2147483647)return t<0?Math.ceil(t):Math.floor(t);return t|0};else o.Cast_Int64=function(t){return t<0?Math.ceil(t):Math.floor(t)};o.Clear=function(t){t.length=0}
;o.PI=3.141592653589793;o.PI2=2*3.141592653589793;o.IntPoint=function(){var t=arguments,e=t.length;this.X=0;this.Y=0;if(r){this.Z=0;if(e==3){this.X=t[0];this.Y=t[1];this.Z=t[2]}else if(e==2){this.X=t[0];this.Y=t[1];this.Z=0}else if(e==1){if(t[0]instanceof o.DoublePoint){var i=t[0];this.X=o.Clipper.Round(i.X);this.Y=o.Clipper.Round(i.Y);this.Z=0}else{var n=t[0];if(typeof n.Z=="undefined")n.Z=0;this.X=n.X;this.Y=n.Y;this.Z=n.Z}}else{this.X=0;this.Y=0;this.Z=0}}else{if(e==2){this.X=t[0];this.Y=t[1]}else if(e==1){if(t[0]instanceof o.DoublePoint){var i=t[0];this.X=o.Clipper.Round(i.X);this.Y=o.Clipper.Round(i.Y)}else{var n=t[0];this.X=n.X;this.Y=n.Y}}else{this.X=0;this.Y=0}}};o.IntPoint.op_Equality=function(t,e){return t.X==e.X&&t.Y==e.Y};o.IntPoint.op_Inequality=function(t,e){return t.X!=e.X||t.Y!=e.Y};if(r){o.IntPoint0=function(){this.X=0;this.Y=0;this.Z=0};o.IntPoint1=function(t){this.X=t.X;this.Y=t.Y;this.Z=t.Z};o.IntPoint1dp=function(t){this.X=o.Clipper.Round(t.X);this.Y=o.Clipper.Round(t.Y);this.Z=0};o.IntPoint2=function(t,e){this.X=t;this.Y=e;this.Z=0};o.IntPoint3=function(t,e,i){this.X=t;this.Y=e;this.Z=i}}else{o.IntPoint0=function(){this.X=0;this.Y=0};o.IntPoint1=function(t){this.X=t.X;this.Y=t.Y};o.IntPoint1dp=function(t){this.X=o.Clipper.Round(t.X);this.Y=o.Clipper.Round(t.Y)};o.IntPoint2=function(t,e){this.X=t;this.Y=e}}o.IntRect=function(){var t=arguments,e=t.length;if(e==4){this.left=t[0];this.top=t[1];this.right=t[2];this.bottom=t[3]}else if(e==1){this.left=ir.left;this.top=ir.top;this.right=ir.right;this.bottom=ir.bottom}else{this.left=0;this.top=0;this.right=0;this.bottom=0}};o.IntRect0=function(){this.left=0;this.top=0;this.right=0;this.bottom=0};o.IntRect1=function(t){this.left=t.left;this.top=t.top;this.right=t.right;this.bottom=t.bottom};o.IntRect4=function(t,e,i,r){this.left=t;this.top=e;this.right=i;this.bottom=r};o.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};o.PolyType={ptSubject:0,ptClip:1};o.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};o.JoinType={jtSquare:0,jtRound:1,jtMiter:2};o.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};if(s)o.EndType_={etSquare:0,etRound:1,etButt:2,etClosed:3};o.EdgeSide={esLeft:0,esRight:1};o.Direction={dRightToLeft:0,dLeftToRight:1};o.TEdge=function(){this.Bot=new o.IntPoint;this.Curr=new o.IntPoint;this.Top=new o.IntPoint;this.Delta=new o.IntPoint;this.Dx=0;this.PolyTyp=o.PolyType.ptSubject;this.Side=o.EdgeSide.esLeft;this.WindDelta=0;this.WindCnt=0;this.WindCnt2=0;this.OutIdx=0;this.Next=null;this.Prev=null;this.NextInLML=null;this.NextInAEL=null;this.PrevInAEL=null;this.NextInSEL=null;this.PrevInSEL=null};o.IntersectNode=function(){this.Edge1=null;this.Edge2=null;this.Pt=new o.IntPoint};o.MyIntersectNodeSort=function(){};o.MyIntersectNodeSort.Compare=function(t,e){return e.Pt.Y-t.Pt.Y};o.LocalMinima=function(){this.Y=0;this.LeftBound=null;this.RightBound=null;this.Next=null};o.Scanbeam=function(){this.Y=0;this.Next=null};o.OutRec=function(){this.Idx=0;this.IsHole=false;this.IsOpen=false;this.FirstLeft=null;this.Pts=null;this.BottomPt=null;this.PolyNode=null};o.OutPt=function(){this.Idx=0;this.Pt=new o.IntPoint;this.Next=null;this.Prev=null};o.Join=function(){this.OutPt1=null;this.OutPt2=null;this.OffPt=new o.IntPoint};o.ClipperBase=function(){this.m_MinimaList=null;this.m_CurrentLM=null;this.m_edges=new Array;this.m_UseFullRange=false;this.m_HasOpenPaths=false;this.PreserveCollinear=false;this.m_MinimaList=null;this.m_CurrentLM=null;this.m_UseFullRange=false;this.m_HasOpenPaths=false};o.ClipperBase.horizontal=-9007199254740992;o.ClipperBase.Skip=-2;o.ClipperBase.Unassigned=-1;o.ClipperBase.tolerance=1e-20;if(e){o.ClipperBase.loRange=46340;o.ClipperBase.hiRange=46340}else{o.ClipperBase.loRange=47453132;o.ClipperBase.hiRange=0xfffffffffffff}o.ClipperBase.near_zero=function(t){return t>-o.ClipperBase.tolerance&&t<o.ClipperBase.tolerance};o.ClipperBase.IsHorizontal=function(t){return t.Delta.Y===0};o.ClipperBase.prototype.PointIsVertex=function(t,e){var i=e;do{if(o.IntPoint.op_Equality(i.Pt,t))return true;i=i.Next}while(i!=e);return false};o.ClipperBase.prototype.PointOnLineSegment=function(t,e,i,r){if(r)return t.X==e.X&&t.Y==e.Y||t.X==i.X&&t.Y==i.Y||t.X>e.X==t.X<i.X&&t.Y>e.Y==t.Y<i.Y&&ge.op_Equality(ge.Int128Mul(t.X-e.X,i.Y-e.Y),ge.Int128Mul(i.X-e.X,t.Y-e.Y));else return t.X==e.X&&t.Y==e.Y||t.X==i.X&&t.Y==i.Y||t.X>e.X==t.X<i.X&&t.Y>e.Y==t.Y<i.Y&&(t.X-e.X)*(i.Y-e.Y)==(i.X-e.X)*(t.Y-e.Y)};o.ClipperBase.prototype.PointOnPolygon=function(t,e,i){var r=e;while(true){if(this.PointOnLineSegment(t,r.Pt,r.Next.Pt,i))return true;r=r.Next;if(r==e)break}return false};o.ClipperBase.prototype.SlopesEqual=o.ClipperBase.SlopesEqual=function(){var t=arguments,e=t.length;var i,r,n,s,l,a,h;if(e==3){i=t[0];r=t[1];h=t[2];if(h)return ge.op_Equality(ge.Int128Mul(i.Delta.Y,r.Delta.X),ge.Int128Mul(i.Delta.X,r.Delta.Y));else return o.Cast_Int64(i.Delta.Y*r.Delta.X)==o.Cast_Int64(i.Delta.X*r.Delta.Y)}else if(e==4){n=t[0];s=t[1];l=t[2];h=t[3];if(h)return ge.op_Equality(ge.Int128Mul(n.Y-s.Y,s.X-l.X),ge.Int128Mul(n.X-s.X,s.Y-l.Y));else return o.Cast_Int64((n.Y-s.Y)*(s.X-l.X))-o.Cast_Int64((n.X-s.X)*(s.Y-l.Y))===0}else{n=t[0];s=t[1];l=t[2];a=t[3];h=t[4];if(h)return ge.op_Equality(ge.Int128Mul(n.Y-s.Y,l.X-a.X),ge.Int128Mul(n.X-s.X,l.Y-a.Y));else return o.Cast_Int64((n.Y-s.Y)*(l.X-a.X))-o.Cast_Int64((n.X-s.X)*(l.Y-a.Y))===0}};o.ClipperBase.SlopesEqual3=function(t,e,i){if(i)return ge.op_Equality(ge.Int128Mul(t.Delta.Y,e.Delta.X),ge.Int128Mul(t.Delta.X,e.Delta.Y));else return o.Cast_Int64(t.Delta.Y*e.Delta.X)==o.Cast_Int64(t.Delta.X*e.Delta.Y)};o.ClipperBase.SlopesEqual4=function(t,e,i,r){if(r)return ge.op_Equality(ge.Int128Mul(t.Y-e.Y,e.X-i.X),ge.Int128Mul(t.X-e.X,e.Y-i.Y));else return o.Cast_Int64((t.Y-e.Y)*(e.X-i.X))-o.Cast_Int64((t.X-e.X)*(e.Y-i.Y))===0};o.ClipperBase.SlopesEqual5=function(t,e,i,r,n){if(n)return ge.op_Equality(ge.Int128Mul(t.Y-e.Y,i.X-r.X),ge.Int128Mul(t.X-e.X,i.Y-r.Y));else return o.Cast_Int64((t.Y-e.Y)*(i.X-r.X))-o.Cast_Int64((t.X-e.X)*(i.Y-r.Y))===0};o.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var t=0,e=this.m_edges.length;t<e;++t){for(var i=0,r=this.m_edges[t].length;i<r;++i)this.m_edges[t][i]=null;o.Clear(this.m_edges[t])}o.Clear(this.m_edges);this.m_UseFullRange=false;this.m_HasOpenPaths=false};o.ClipperBase.prototype.DisposeLocalMinimaList=function(){while(this.m_MinimaList!==null){var t=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=t}this.m_CurrentLM=null};o.ClipperBase.prototype.RangeTest=function(t,e){if(e.Value){if(t.X>o.ClipperBase.hiRange||t.Y>o.ClipperBase.hiRange||-t.X>o.ClipperBase.hiRange||-t.Y>o.ClipperBase.hiRange)o.Error("Coordinate outside allowed range in RangeTest().")}else if(t.X>o.ClipperBase.loRange||t.Y>o.ClipperBase.loRange||-t.X>o.ClipperBase.loRange||-t.Y>o.ClipperBase.loRange){e.Value=true;this.RangeTest(t,e)}};o.ClipperBase.prototype.InitEdge=function(t,e,i,r){t.Next=e;t.Prev=i;t.Curr.X=r.X;t.Curr.Y=r.Y;t.OutIdx=-1};o.ClipperBase.prototype.InitEdge2=function(t,e){if(t.Curr.Y>=t.Next.Curr.Y){t.Bot.X=t.Curr.X;t.Bot.Y=t.Curr.Y;t.Top.X=t.Next.Curr.X;t.Top.Y=t.Next.Curr.Y}else{t.Top.X=t.Curr.X;t.Top.Y=t.Curr.Y;t.Bot.X=t.Next.Curr.X;t.Bot.Y=t.Next.Curr.Y}this.SetDx(t);t.PolyTyp=e};o.ClipperBase.prototype.FindNextLocMin=function(t){var e;for(;;){while(o.IntPoint.op_Inequality(t.Bot,t.Prev.Bot)||o.IntPoint.op_Equality(t.Curr,t.Top))t=t.Next;if(t.Dx!=o.ClipperBase.horizontal&&t.Prev.Dx!=o.ClipperBase.horizontal)break;while(t.Prev.Dx==o.ClipperBase.horizontal)t=t.Prev;e=t;while(t.Dx==o.ClipperBase.horizontal)t=t.Next;if(t.Top.Y==t.Prev.Bot.Y)continue;if(e.Prev.Bot.X<t.Bot.X)t=e;break}return t};o.ClipperBase.prototype.ProcessBound=function(t,e){var i=t,r=t;var n;var s;if(t.Dx==o.ClipperBase.horizontal){if(e)s=t.Prev.Bot.X;else s=t.Next.Bot.X;if(t.Bot.X!=s)this.ReverseHorizontal(t)}if(r.OutIdx!=o.ClipperBase.Skip){if(e){while(r.Top.Y==r.Next.Bot.Y&&r.Next.OutIdx!=o.ClipperBase.Skip)r=r.Next;if(r.Dx==o.ClipperBase.horizontal&&r.Next.OutIdx!=o.ClipperBase.Skip){n=r;while(n.Prev.Dx==o.ClipperBase.horizontal)n=n.Prev;if(n.Prev.Top.X==r.Next.Top.X){if(!e)r=n.Prev}else if(n.Prev.Top.X>r.Next.Top.X)r=n.Prev}while(t!=r){t.NextInLML=t.Next;if(t.Dx==o.ClipperBase.horizontal&&t!=i&&t.Bot.X!=t.Prev.Top.X)this.ReverseHorizontal(t);t=t.Next}if(t.Dx==o.ClipperBase.horizontal&&t!=i&&t.Bot.X!=t.Prev.Top.X)this.ReverseHorizontal(t);r=r.Next}else{while(r.Top.Y==r.Prev.Bot.Y&&r.Prev.OutIdx!=o.ClipperBase.Skip)r=r.Prev;if(r.Dx==o.ClipperBase.horizontal&&r.Prev.OutIdx!=o.ClipperBase.Skip){n=r;while(n.Next.Dx==o.ClipperBase.horizontal)n=n.Next;if(n.Next.Top.X==r.Prev.Top.X){if(!e)r=n.Next}else if(n.Next.Top.X>r.Prev.Top.X)r=n.Next}while(t!=r){t.NextInLML=t.Prev;if(t.Dx==o.ClipperBase.horizontal&&t!=i&&t.Bot.X!=t.Next.Top.X)this.ReverseHorizontal(t);t=t.Prev}if(t.Dx==o.ClipperBase.horizontal&&t!=i&&t.Bot.X!=t.Next.Top.X)this.ReverseHorizontal(t);r=r.Prev}}if(r.OutIdx==o.ClipperBase.Skip){t=r;if(e){while(t.Top.Y==t.Next.Bot.Y)t=t.Next;while(t!=r&&t.Dx==o.ClipperBase.horizontal)t=t.Prev}else{while(t.Top.Y==t.Prev.Bot.Y)t=t.Prev;while(t!=r&&t.Dx==o.ClipperBase.horizontal)t=t.Next}if(t==r){if(e)r=t.Next;else r=t.Prev}else{if(e)t=r.Next;else t=r.Prev;var l=new o.LocalMinima;l.Next=null;l.Y=t.Bot.Y;l.LeftBound=null;l.RightBound=t;l.RightBound.WindDelta=0;r=this.ProcessBound(l.RightBound,e);this.InsertLocalMinima(l)}}return r};o.ClipperBase.prototype.AddPath=function(t,e,i){if(n){if(!i&&e==o.PolyType.ptClip)o.Error("AddPath: Open paths must be subject.")}else{if(!i)o.Error("AddPath: Open paths have been disabled.")}var r=t.length-1;if(i)while(r>0&&o.IntPoint.op_Equality(t[r],t[0]))--r;while(r>0&&o.IntPoint.op_Equality(t[r],t[r-1]))--r;if(i&&r<2||!i&&r<1)return false;var s=new Array;for(var l=0;l<=r;l++)s.push(new o.TEdge);var a=true;s[1].Curr.X=t[1].X;s[1].Curr.Y=t[1].Y;var h={Value:this.m_UseFullRange};this.RangeTest(t[0],h);this.m_UseFullRange=h.Value;h.Value=this.m_UseFullRange;this.RangeTest(t[r],h);this.m_UseFullRange=h.Value;this.InitEdge(s[0],s[1],s[r],t[0]);this.InitEdge(s[r],s[0],s[r-1],t[r]);for(var l=r-1;l>=1;--l){h.Value=this.m_UseFullRange;this.RangeTest(t[l],h);this.m_UseFullRange=h.Value;this.InitEdge(s[l],s[l+1],s[l-1],t[l])}var u=s[0];var p=u,f=u;for(;;){if(o.IntPoint.op_Equality(p.Curr,p.Next.Curr)){if(p==p.Next)break;if(p==u)u=p.Next;p=this.RemoveEdge(p);f=p;continue}if(p.Prev==p.Next)break;else if(i&&o.ClipperBase.SlopesEqual(p.Prev.Curr,p.Curr,p.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(p.Prev.Curr,p.Curr,p.Next.Curr))){if(p==u)u=p.Next;p=this.RemoveEdge(p);p=p.Prev;f=p;continue}p=p.Next;if(p==f)break}if(!i&&p==p.Next||i&&p.Prev==p.Next)return false;if(!i){this.m_HasOpenPaths=true;u.Prev.OutIdx=o.ClipperBase.Skip}var d=u;p=u;do{this.InitEdge2(p,e);p=p.Next;if(a&&p.Curr.Y!=u.Curr.Y)a=false}while(p!=u);if(a){if(i)return false;p.Prev.OutIdx=o.ClipperBase.Skip;if(p.Prev.Bot.X<p.Prev.Top.X)this.ReverseHorizontal(p.Prev);var v=new o.LocalMinima;v.Next=null;v.Y=p.Bot.Y;v.LeftBound=null;v.RightBound=p;v.RightBound.Side=o.EdgeSide.esRight;v.RightBound.WindDelta=0;while(p.Next.OutIdx!=o.ClipperBase.Skip){p.NextInLML=p.Next;if(p.Bot.X!=p.Prev.Top.X)this.ReverseHorizontal(p);p=p.Next}this.InsertLocalMinima(v);this.m_edges.push(s);return true}this.m_edges.push(s);var c;var P=null;for(;;){p=this.FindNextLocMin(p);if(p==P)break;else if(P==null)P=p;var v=new o.LocalMinima;v.Next=null;v.Y=p.Bot.Y;if(p.Dx<p.Prev.Dx){v.LeftBound=p.Prev;v.RightBound=p;c=false}else{v.LeftBound=p;v.RightBound=p.Prev;c=true}v.LeftBound.Side=o.EdgeSide.esLeft;v.RightBound.Side=o.EdgeSide.esRight;if(!i)v.LeftBound.WindDelta=0;else if(v.LeftBound.Next==v.RightBound)v.LeftBound.WindDelta=-1;else v.LeftBound.WindDelta=1;v.RightBound.WindDelta=-v.LeftBound.WindDelta;p=this.ProcessBound(v.LeftBound,c);var m=this.ProcessBound(v.RightBound,!c);if(v.LeftBound.OutIdx==o.ClipperBase.Skip)v.LeftBound=null;else if(v.RightBound.OutIdx==o.ClipperBase.Skip)v.RightBound=null;this.InsertLocalMinima(v);if(!c)p=m}return true};o.ClipperBase.prototype.AddPaths=function(t,e,i){var r=false;for(var n=0,s=t.length;n<s;++n)if(this.AddPath(t[n],e,i))r=true;return r};o.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(t,e,i){if(o.IntPoint.op_Equality(t,i)||o.IntPoint.op_Equality(t,e)||o.IntPoint.op_Equality(i,e))return false;else if(t.X!=i.X)return e.X>t.X==e.X<i.X;else return e.Y>t.Y==e.Y<i.Y};o.ClipperBase.prototype.RemoveEdge=function(t){t.Prev.Next=t.Next;t.Next.Prev=t.Prev;var e=t.Next;t.Prev=null;return e};o.ClipperBase.prototype.SetDx=function(t){t.Delta.X=t.Top.X-t.Bot.X;t.Delta.Y=t.Top.Y-t.Bot.Y;if(t.Delta.Y===0)t.Dx=o.ClipperBase.horizontal;else t.Dx=t.Delta.X/t.Delta.Y};o.ClipperBase.prototype.InsertLocalMinima=function(t){if(this.m_MinimaList===null){this.m_MinimaList=t}else if(t.Y>=this.m_MinimaList.Y){t.Next=this.m_MinimaList;this.m_MinimaList=t}else{var e=this.m_MinimaList;while(e.Next!==null&&t.Y<e.Next.Y)e=e.Next;t.Next=e.Next;e.Next=t}};o.ClipperBase.prototype.PopLocalMinima=function(){if(this.m_CurrentLM===null)return;this.m_CurrentLM=this.m_CurrentLM.Next};o.ClipperBase.prototype.ReverseHorizontal=function(t){var e=t.Top.X;t.Top.X=t.Bot.X;t.Bot.X=e;if(r){e=t.Top.Z;t.Top.Z=t.Bot.Z;t.Bot.Z=e}};o.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;if(this.m_CurrentLM==null)return;var t=this.m_MinimaList;while(t!=null){var e=t.LeftBound;if(e!=null){e.Curr.X=e.Bot.X;e.Curr.Y=e.Bot.Y;e.Side=o.EdgeSide.esLeft;e.OutIdx=o.ClipperBase.Unassigned}e=t.RightBound;if(e!=null){e.Curr.X=e.Bot.X;e.Curr.Y=e.Bot.Y;e.Side=o.EdgeSide.esRight;e.OutIdx=o.ClipperBase.Unassigned}t=t.Next}};o.Clipper=function(t){if(typeof t=="undefined")t=0;this.m_PolyOuts=null;this.m_ClipType=o.ClipType.ctIntersection;this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectList=null;this.m_IntersectNodeComparer=null;this.m_ExecuteLocked=false;this.m_ClipFillType=o.PolyFillType.pftEvenOdd;this.m_SubjFillType=o.PolyFillType.pftEvenOdd;this.m_Joins=null;this.m_GhostJoins=null;this.m_UsingPolyTree=false;this.ReverseSolution=false;this.StrictlySimple=false;o.ClipperBase.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectList=new Array;this.m_IntersectNodeComparer=o.MyIntersectNodeSort.Compare;this.m_ExecuteLocked=false;this.m_UsingPolyTree=false;this.m_PolyOuts=new Array;this.m_Joins=new Array;this.m_GhostJoins=new Array;this.ReverseSolution=(1&t)!==0;this.StrictlySimple=(2&t)!==0;this.PreserveCollinear=(4&t)!==0;if(r){this.ZFillFunction=null}};o.Clipper.ioReverseSolution=1;o.Clipper.ioStrictlySimple=2;o.Clipper.ioPreserveCollinear=4;o.Clipper.prototype.Clear=function(){if(this.m_edges.length===0)return;this.DisposeAllPolyPts();o.ClipperBase.prototype.Clear.call(this)};o.Clipper.prototype.DisposeScanbeamList=function(){while(this.m_Scanbeam!==null){var t=this.m_Scanbeam.Next;this.m_Scanbeam=null;this.m_Scanbeam=t}};o.Clipper.prototype.Reset=function(){o.ClipperBase.prototype.Reset.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;var t=this.m_MinimaList;while(t!==null){this.InsertScanbeam(t.Y);t=t.Next}};o.Clipper.prototype.InsertScanbeam=function(t){if(this.m_Scanbeam===null){this.m_Scanbeam=new o.Scanbeam;this.m_Scanbeam.Next=null;this.m_Scanbeam.Y=t}else if(t>this.m_Scanbeam.Y){var e=new o.Scanbeam;e.Y=t;e.Next=this.m_Scanbeam;this.m_Scanbeam=e}else{var i=this.m_Scanbeam;while(i.Next!==null&&t<=i.Next.Y)i=i.Next;if(t==i.Y)return;var e=new o.Scanbeam;e.Y=t;e.Next=i.Next;i.Next=e}};o.Clipper.prototype.Execute=function(){var t=arguments,e=t.length,i=t[1]instanceof o.PolyTree;if(e==4&&!i){var r=t[0],n=t[1],s=t[2],l=t[3];if(this.m_ExecuteLocked)return false;if(this.m_HasOpenPaths)o.Error("Error: PolyTree struct is need for open path clipping.");this.m_ExecuteLocked=true;o.Clear(n);this.m_SubjFillType=s;this.m_ClipFillType=l;this.m_ClipType=r;this.m_UsingPolyTree=false;try{var a=this.ExecuteInternal();if(a)this.BuildResult(n)}finally{this.DisposeAllPolyPts();this.m_ExecuteLocked=false}return a}else if(e==4&&i){var r=t[0],h=t[1],s=t[2],l=t[3];if(this.m_ExecuteLocked)return false;this.m_ExecuteLocked=true;this.m_SubjFillType=s;this.m_ClipFillType=l;this.m_ClipType=r;this.m_UsingPolyTree=true;try{var a=this.ExecuteInternal();if(a)this.BuildResult2(h)}finally{this.DisposeAllPolyPts();this.m_ExecuteLocked=false}return a}else if(e==2&&!i){var r=t[0],n=t[1];return this.Execute(r,n,o.PolyFillType.pftEvenOdd,o.PolyFillType.pftEvenOdd)}else if(e==2&&i){var r=t[0],h=t[1];return this.Execute(r,h,o.PolyFillType.pftEvenOdd,o.PolyFillType.pftEvenOdd)}};o.Clipper.prototype.FixHoleLinkage=function(t){if(t.FirstLeft===null||t.IsHole!=t.FirstLeft.IsHole&&t.FirstLeft.Pts!==null)return;var e=t.FirstLeft;while(e!==null&&(e.IsHole==t.IsHole||e.Pts===null))e=e.FirstLeft;t.FirstLeft=e};o.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(this.m_CurrentLM===null)return false;var t=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(t);o.Clear(this.m_GhostJoins);this.ProcessHorizontals(false);if(this.m_Scanbeam===null)break;var e=this.PopScanbeam();if(!this.ProcessIntersections(t,e))return false;this.ProcessEdgesAtTopOfScanbeam(e);t=e}while(this.m_Scanbeam!==null||this.m_CurrentLM!==null);for(var i=0,r=this.m_PolyOuts.length;i<r;i++){var n=this.m_PolyOuts[i];if(n.Pts===null||n.IsOpen)continue;if((n.IsHole^this.ReverseSolution)==this.Area(n)>0)this.ReversePolyPtLinks(n.Pts)}this.JoinCommonEdges();for(var i=0,r=this.m_PolyOuts.length;i<r;i++){var n=this.m_PolyOuts[i];if(n.Pts!==null&&!n.IsOpen)this.FixupOutPolygon(n)}if(this.StrictlySimple)this.DoSimplePolygons();return true}finally{o.Clear(this.m_Joins);o.Clear(this.m_GhostJoins)}};o.Clipper.prototype.PopScanbeam=function(){var t=this.m_Scanbeam.Y;var e=this.m_Scanbeam;this.m_Scanbeam=this.m_Scanbeam.Next;e=null;return t};o.Clipper.prototype.DisposeAllPolyPts=function(){for(var t=0,e=this.m_PolyOuts.length;t<e;++t)this.DisposeOutRec(t);o.Clear(this.m_PolyOuts)};o.Clipper.prototype.DisposeOutRec=function(t){var e=this.m_PolyOuts[t];if(e.Pts!==null)this.DisposeOutPts(e.Pts);e=null;this.m_PolyOuts[t]=null};o.Clipper.prototype.DisposeOutPts=function(t){if(t===null)return;var e=null;t.Prev.Next=null;while(t!==null){e=t;t=t.Next;e=null}};o.Clipper.prototype.AddJoin=function(t,e,i){var r=new o.Join;r.OutPt1=t;r.OutPt2=e;r.OffPt.X=i.X;r.OffPt.Y=i.Y;this.m_Joins.push(r)};o.Clipper.prototype.AddGhostJoin=function(t,e){var i=new o.Join;i.OutPt1=t;i.OffPt.X=e.X;i.OffPt.Y=e.Y;this.m_GhostJoins.push(i)};if(r){o.Clipper.prototype.SetZ=function(t,e){t.Z=0;if(this.ZFillFunction!==null){if(e.OutIdx<0)this.ZFillFunction(e.Bot,e.Top,t);else this.ZFillFunction(e.Top,e.Bot,t)}}}o.Clipper.prototype.InsertLocalMinimaIntoAEL=function(t){while(this.m_CurrentLM!==null&&this.m_CurrentLM.Y==t){var e=this.m_CurrentLM.LeftBound;var i=this.m_CurrentLM.RightBound;this.PopLocalMinima();var r=null;if(e===null){this.InsertEdgeIntoAEL(i,null);this.SetWindingCount(i);if(this.IsContributing(i))r=this.AddOutPt(i,i.Bot)}else if(i==null){this.InsertEdgeIntoAEL(e,null);this.SetWindingCount(e);if(this.IsContributing(e))r=this.AddOutPt(e,e.Bot);this.InsertScanbeam(e.Top.Y)}else{this.InsertEdgeIntoAEL(e,null);this.InsertEdgeIntoAEL(i,e);this.SetWindingCount(e);i.WindCnt=e.WindCnt;i.WindCnt2=e.WindCnt2;if(this.IsContributing(e))r=this.AddLocalMinPoly(e,i,e.Bot);this.InsertScanbeam(e.Top.Y)}if(i!=null){if(o.ClipperBase.IsHorizontal(i))this.AddEdgeToSEL(i);else this.InsertScanbeam(i.Top.Y)}if(e==null||i==null)continue;if(r!==null&&o.ClipperBase.IsHorizontal(i)&&this.m_GhostJoins.length>0&&i.WindDelta!==0){for(var n=0,s=this.m_GhostJoins.length;n<s;n++){var l=this.m_GhostJoins[n];if(this.HorzSegmentsOverlap(l.OutPt1.Pt,l.OffPt,i.Bot,i.Top))this.AddJoin(l.OutPt1,r,l.OffPt)}}if(e.OutIdx>=0&&e.PrevInAEL!==null&&e.PrevInAEL.Curr.X==e.Bot.X&&e.PrevInAEL.OutIdx>=0&&o.ClipperBase.SlopesEqual(e.PrevInAEL,e,this.m_UseFullRange)&&e.WindDelta!==0&&e.PrevInAEL.WindDelta!==0){var a=this.AddOutPt(e.PrevInAEL,e.Bot);this.AddJoin(r,a,e.Top)}if(e.NextInAEL!=i){if(i.OutIdx>=0&&i.PrevInAEL.OutIdx>=0&&o.ClipperBase.SlopesEqual(i.PrevInAEL,i,this.m_UseFullRange)&&i.WindDelta!==0&&i.PrevInAEL.WindDelta!==0){var a=this.AddOutPt(i.PrevInAEL,i.Bot);this.AddJoin(r,a,i.Top)}var h=e.NextInAEL;if(h!==null)while(h!=i){this.IntersectEdges(i,h,e.Curr,false);h=h.NextInAEL}}}};o.Clipper.prototype.InsertEdgeIntoAEL=function(t,e){if(this.m_ActiveEdges===null){t.PrevInAEL=null;t.NextInAEL=null;this.m_ActiveEdges=t}else if(e===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,t)){t.PrevInAEL=null;t.NextInAEL=this.m_ActiveEdges;this.m_ActiveEdges.PrevInAEL=t;this.m_ActiveEdges=t}else{if(e===null)e=this.m_ActiveEdges;while(e.NextInAEL!==null&&!this.E2InsertsBeforeE1(e.NextInAEL,t))e=e.NextInAEL;t.NextInAEL=e.NextInAEL;if(e.NextInAEL!==null)e.NextInAEL.PrevInAEL=t;t.PrevInAEL=e;e.NextInAEL=t}};o.Clipper.prototype.E2InsertsBeforeE1=function(t,e){if(e.Curr.X==t.Curr.X){if(e.Top.Y>t.Top.Y)return e.Top.X<o.Clipper.TopX(t,e.Top.Y);else return t.Top.X>o.Clipper.TopX(e,t.Top.Y)}else return e.Curr.X<t.Curr.X};o.Clipper.prototype.IsEvenOddFillType=function(t){if(t.PolyTyp==o.PolyType.ptSubject)return this.m_SubjFillType==o.PolyFillType.pftEvenOdd;else return this.m_ClipFillType==o.PolyFillType.pftEvenOdd};o.Clipper.prototype.IsEvenOddAltFillType=function(t){if(t.PolyTyp==o.PolyType.ptSubject)return this.m_ClipFillType==o.PolyFillType.pftEvenOdd;else return this.m_SubjFillType==o.PolyFillType.pftEvenOdd};o.Clipper.prototype.IsContributing=function(t){var e,i;if(t.PolyTyp==o.PolyType.ptSubject){e=this.m_SubjFillType;i=this.m_ClipFillType}else{e=this.m_ClipFillType;i=this.m_SubjFillType}switch(e){case o.PolyFillType.pftEvenOdd:if(t.WindDelta===0&&t.WindCnt!=1)return false;break;case o.PolyFillType.pftNonZero:if(Math.abs(t.WindCnt)!=1)return false;break;case o.PolyFillType.pftPositive:if(t.WindCnt!=1)return false;break;default:if(t.WindCnt!=-1)return false;break}switch(this.m_ClipType){case o.ClipType.ctIntersection:switch(i){case o.PolyFillType.pftEvenOdd:case o.PolyFillType.pftNonZero:return t.WindCnt2!==0;case o.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case o.ClipType.ctUnion:switch(i){case o.PolyFillType.pftEvenOdd:case o.PolyFillType.pftNonZero:return t.WindCnt2===0;case o.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}case o.ClipType.ctDifference:if(t.PolyTyp==o.PolyType.ptSubject)switch(i){case o.PolyFillType.pftEvenOdd:case o.PolyFillType.pftNonZero:return t.WindCnt2===0;case o.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}else switch(i){case o.PolyFillType.pftEvenOdd:case o.PolyFillType.pftNonZero:return t.WindCnt2!==0;case o.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case o.ClipType.ctXor:if(t.WindDelta===0)switch(i){case o.PolyFillType.pftEvenOdd:case o.PolyFillType.pftNonZero:return t.WindCnt2===0;case o.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}else return true}return true};o.Clipper.prototype.SetWindingCount=function(t){var e=t.PrevInAEL;while(e!==null&&(e.PolyTyp!=t.PolyTyp||e.WindDelta===0))e=e.PrevInAEL;if(e===null){t.WindCnt=t.WindDelta===0?1:t.WindDelta;t.WindCnt2=0;e=this.m_ActiveEdges}else if(t.WindDelta===0&&this.m_ClipType!=o.ClipType.ctUnion){t.WindCnt=1;t.WindCnt2=e.WindCnt2;e=e.NextInAEL}else if(this.IsEvenOddFillType(t)){if(t.WindDelta===0){var i=true;var r=e.PrevInAEL;while(r!==null){if(r.PolyTyp==e.PolyTyp&&r.WindDelta!==0)i=!i;r=r.PrevInAEL}t.WindCnt=i?0:1}else{t.WindCnt=t.WindDelta}t.WindCnt2=e.WindCnt2;e=e.NextInAEL}else{if(e.WindCnt*e.WindDelta<0){if(Math.abs(e.WindCnt)>1){if(e.WindDelta*t.WindDelta<0)t.WindCnt=e.WindCnt;else t.WindCnt=e.WindCnt+t.WindDelta}else t.WindCnt=t.WindDelta===0?1:t.WindDelta}else{if(t.WindDelta===0)t.WindCnt=e.WindCnt<0?e.WindCnt-1:e.WindCnt+1;else if(e.WindDelta*t.WindDelta<0)t.WindCnt=e.WindCnt;else t.WindCnt=e.WindCnt+t.WindDelta}t.WindCnt2=e.WindCnt2;e=e.NextInAEL}if(this.IsEvenOddAltFillType(t)){while(e!=t){if(e.WindDelta!==0)t.WindCnt2=t.WindCnt2===0?1:0;e=e.NextInAEL}}else{while(e!=t){t.WindCnt2+=e.WindDelta;e=e.NextInAEL}}};o.Clipper.prototype.AddEdgeToSEL=function(t){if(this.m_SortedEdges===null){this.m_SortedEdges=t;t.PrevInSEL=null;t.NextInSEL=null}else{t.NextInSEL=this.m_SortedEdges;t.PrevInSEL=null;this.m_SortedEdges.PrevInSEL=t;this.m_SortedEdges=t}};o.Clipper.prototype.CopyAELToSEL=function(){var t=this.m_ActiveEdges;this.m_SortedEdges=t;while(t!==null){t.PrevInSEL=t.PrevInAEL;t.NextInSEL=t.NextInAEL;t=t.NextInAEL}};o.Clipper.prototype.SwapPositionsInAEL=function(t,e){if(t.NextInAEL==t.PrevInAEL||e.NextInAEL==e.PrevInAEL)return;if(t.NextInAEL==e){var i=e.NextInAEL;if(i!==null)i.PrevInAEL=t;var r=t.PrevInAEL;if(r!==null)r.NextInAEL=e;e.PrevInAEL=r;e.NextInAEL=t;t.PrevInAEL=e;t.NextInAEL=i}else if(e.NextInAEL==t){var i=t.NextInAEL;if(i!==null)i.PrevInAEL=e;var r=e.PrevInAEL;if(r!==null)r.NextInAEL=t;t.PrevInAEL=r;t.NextInAEL=e;e.PrevInAEL=t;e.NextInAEL=i}else{var i=t.NextInAEL;var r=t.PrevInAEL;t.NextInAEL=e.NextInAEL;if(t.NextInAEL!==null)t.NextInAEL.PrevInAEL=t;t.PrevInAEL=e.PrevInAEL;if(t.PrevInAEL!==null)t.PrevInAEL.NextInAEL=t;e.NextInAEL=i;if(e.NextInAEL!==null)e.NextInAEL.PrevInAEL=e;e.PrevInAEL=r;if(e.PrevInAEL!==null)e.PrevInAEL.NextInAEL=e}if(t.PrevInAEL===null)this.m_ActiveEdges=t;else if(e.PrevInAEL===null)this.m_ActiveEdges=e};o.Clipper.prototype.SwapPositionsInSEL=function(t,e){if(t.NextInSEL===null&&t.PrevInSEL===null)return;if(e.NextInSEL===null&&e.PrevInSEL===null)return;if(t.NextInSEL==e){var i=e.NextInSEL;if(i!==null)i.PrevInSEL=t;var r=t.PrevInSEL;if(r!==null)r.NextInSEL=e;e.PrevInSEL=r;e.NextInSEL=t;t.PrevInSEL=e;t.NextInSEL=i}else if(e.NextInSEL==t){var i=t.NextInSEL;if(i!==null)i.PrevInSEL=e;var r=e.PrevInSEL;if(r!==null)r.NextInSEL=t;t.PrevInSEL=r;t.NextInSEL=e;e.PrevInSEL=t;e.NextInSEL=i}else{var i=t.NextInSEL;var r=t.PrevInSEL;t.NextInSEL=e.NextInSEL;if(t.NextInSEL!==null)t.NextInSEL.PrevInSEL=t;t.PrevInSEL=e.PrevInSEL;if(t.PrevInSEL!==null)t.PrevInSEL.NextInSEL=t;e.NextInSEL=i;if(e.NextInSEL!==null)e.NextInSEL.PrevInSEL=e;e.PrevInSEL=r;if(e.PrevInSEL!==null)e.PrevInSEL.NextInSEL=e}if(t.PrevInSEL===null)this.m_SortedEdges=t;else if(e.PrevInSEL===null)this.m_SortedEdges=e};o.Clipper.prototype.AddLocalMaxPoly=function(t,e,i){this.AddOutPt(t,i);if(e.WindDelta==0)this.AddOutPt(e,i);if(t.OutIdx==e.OutIdx){t.OutIdx=-1;e.OutIdx=-1}else if(t.OutIdx<e.OutIdx)this.AppendPolygon(t,e);else this.AppendPolygon(e,t)};o.Clipper.prototype.AddLocalMinPoly=function(t,e,i){var r;var n,s;if(o.ClipperBase.IsHorizontal(e)||t.Dx>e.Dx){r=this.AddOutPt(t,i);e.OutIdx=t.OutIdx;t.Side=o.EdgeSide.esLeft;e.Side=o.EdgeSide.esRight;n=t;if(n.PrevInAEL==e)s=e.PrevInAEL;else s=n.PrevInAEL}else{r=this.AddOutPt(e,i);t.OutIdx=e.OutIdx;t.Side=o.EdgeSide.esRight;e.Side=o.EdgeSide.esLeft;n=e;if(n.PrevInAEL==t)s=t.PrevInAEL;else s=n.PrevInAEL}if(s!==null&&s.OutIdx>=0&&o.Clipper.TopX(s,i.Y)==o.Clipper.TopX(n,i.Y)&&o.ClipperBase.SlopesEqual(n,s,this.m_UseFullRange)&&n.WindDelta!==0&&s.WindDelta!==0){var l=this.AddOutPt(s,i);this.AddJoin(r,l,n.Top)}return r};o.Clipper.prototype.CreateOutRec=function(){var t=new o.OutRec;t.Idx=-1;t.IsHole=false;t.IsOpen=false;t.FirstLeft=null;t.Pts=null;t.BottomPt=null;t.PolyNode=null;this.m_PolyOuts.push(t);t.Idx=this.m_PolyOuts.length-1;return t};o.Clipper.prototype.AddOutPt=function(t,e){var i=t.Side==o.EdgeSide.esLeft;if(t.OutIdx<0){var n=this.CreateOutRec();n.IsOpen=t.WindDelta===0;var s=new o.OutPt;n.Pts=s;s.Idx=n.Idx;s.Pt.X=e.X;s.Pt.Y=e.Y;s.Next=s;s.Prev=s;if(!n.IsOpen)this.SetHoleState(t,n);if(r){if(o.IntPoint.op_Equality(e,t.Bot)){s.Pt.X=t.Bot.X;s.Pt.Y=t.Bot.Y;s.Pt.Z=t.Bot.Z}else if(o.IntPoint.op_Equality(e,t.Top)){s.Pt.X=t.Top.X;s.Pt.Y=t.Top.Y;s.Pt.Z=t.Top.Z}else this.SetZ(s.Pt,t)}t.OutIdx=n.Idx;return s}else{var n=this.m_PolyOuts[t.OutIdx];var l=n.Pts;if(i&&o.IntPoint.op_Equality(e,l.Pt))return l;else if(!i&&o.IntPoint.op_Equality(e,l.Prev.Pt))return l.Prev;var s=new o.OutPt;s.Idx=n.Idx;s.Pt.X=e.X;s.Pt.Y=e.Y;s.Next=l;s.Prev=l.Prev;s.Prev.Next=s;l.Prev=s;if(i)n.Pts=s;if(r){if(o.IntPoint.op_Equality(e,t.Bot)){s.Pt.X=t.Bot.X;s.Pt.Y=t.Bot.Y;s.Pt.Z=t.Bot.Z}else if(o.IntPoint.op_Equality(e,t.Top)){s.Pt.X=t.Top.X;s.Pt.Y=t.Top.Y;s.Pt.Z=t.Top.Z}else this.SetZ(s.Pt,t)}return s}};o.Clipper.prototype.SwapPoints=function(t,e){var i=new o.IntPoint(t.Value);t.Value.X=e.Value.X;t.Value.Y=e.Value.Y;e.Value.X=i.X;e.Value.Y=i.Y};o.Clipper.prototype.HorzSegmentsOverlap=function(t,e,i,r){if(t.X>i.X==t.X<r.X)return true;else if(e.X>i.X==e.X<r.X)return true;else if(i.X>t.X==i.X<e.X)return true;else if(r.X>t.X==r.X<e.X)return true;else if(t.X==i.X&&e.X==r.X)return true;else if(t.X==r.X&&e.X==i.X)return true;else return false};o.Clipper.prototype.InsertPolyPtBetween=function(t,e,i){var r=new o.OutPt;r.Pt.X=i.X;r.Pt.Y=i.Y;if(e==t.Next){t.Next=r;e.Prev=r;r.Next=e;r.Prev=t}else{e.Next=r;t.Prev=r;r.Next=t;r.Prev=e}return r};o.Clipper.prototype.SetHoleState=function(t,e){var i=false;var r=t.PrevInAEL;while(r!==null){if(r.OutIdx>=0&&r.WindDelta!=0){i=!i;if(e.FirstLeft===null)e.FirstLeft=this.m_PolyOuts[r.OutIdx]}r=r.PrevInAEL}if(i)e.IsHole=true};o.Clipper.prototype.GetDx=function(t,e){if(t.Y==e.Y)return o.ClipperBase.horizontal;else return(e.X-t.X)/(e.Y-t.Y)};o.Clipper.prototype.FirstIsBottomPt=function(t,e){var i=t.Prev;while(o.IntPoint.op_Equality(i.Pt,t.Pt)&&i!=t)i=i.Prev;var r=Math.abs(this.GetDx(t.Pt,i.Pt));i=t.Next;while(o.IntPoint.op_Equality(i.Pt,t.Pt)&&i!=t)i=i.Next;var n=Math.abs(this.GetDx(t.Pt,i.Pt));i=e.Prev;while(o.IntPoint.op_Equality(i.Pt,e.Pt)&&i!=e)i=i.Prev;var s=Math.abs(this.GetDx(e.Pt,i.Pt));i=e.Next;while(o.IntPoint.op_Equality(i.Pt,e.Pt)&&i!=e)i=i.Next;var l=Math.abs(this.GetDx(e.Pt,i.Pt));return r>=s&&r>=l||n>=s&&n>=l};o.Clipper.prototype.GetBottomPt=function(t){var e=null;var i=t.Next;while(i!=t){if(i.Pt.Y>t.Pt.Y){t=i;e=null}else if(i.Pt.Y==t.Pt.Y&&i.Pt.X<=t.Pt.X){if(i.Pt.X<t.Pt.X){e=null;t=i}else{if(i.Next!=t&&i.Prev!=t)e=i}}i=i.Next}if(e!==null){while(e!=i){if(!this.FirstIsBottomPt(i,e))t=e;e=e.Next;while(o.IntPoint.op_Inequality(e.Pt,t.Pt))e=e.Next}}return t};o.Clipper.prototype.GetLowermostRec=function(t,e){if(t.BottomPt===null)t.BottomPt=this.GetBottomPt(t.Pts);if(e.BottomPt===null)e.BottomPt=this.GetBottomPt(e.Pts);var i=t.BottomPt;var r=e.BottomPt;if(i.Pt.Y>r.Pt.Y)return t;else if(i.Pt.Y<r.Pt.Y)return e;else if(i.Pt.X<r.Pt.X)return t;else if(i.Pt.X>r.Pt.X)return e;else if(i.Next==i)return e;else if(r.Next==r)return t;else if(this.FirstIsBottomPt(i,r))return t;else return e};o.Clipper.prototype.Param1RightOfParam2=function(t,e){do{t=t.FirstLeft;if(t==e)return true}while(t!==null);return false};o.Clipper.prototype.GetOutRec=function(t){var e=this.m_PolyOuts[t];while(e!=this.m_PolyOuts[e.Idx])e=this.m_PolyOuts[e.Idx];return e};o.Clipper.prototype.AppendPolygon=function(t,e){var i=this.m_PolyOuts[t.OutIdx];var r=this.m_PolyOuts[e.OutIdx];var n;if(this.Param1RightOfParam2(i,r))n=r;else if(this.Param1RightOfParam2(r,i))n=i;else n=this.GetLowermostRec(i,r);var s=i.Pts;var l=s.Prev;var a=r.Pts;var h=a.Prev;var u;if(t.Side==o.EdgeSide.esLeft){if(e.Side==o.EdgeSide.esLeft){this.ReversePolyPtLinks(a);a.Next=s;s.Prev=a;l.Next=h;h.Prev=l;i.Pts=h}else{h.Next=s;s.Prev=h;a.Prev=l;l.Next=a;i.Pts=a}u=o.EdgeSide.esLeft}else{if(e.Side==o.EdgeSide.esRight){this.ReversePolyPtLinks(a);l.Next=h;h.Prev=l;a.Next=s;s.Prev=a}else{l.Next=a;a.Prev=l;s.Prev=h;h.Next=s}u=o.EdgeSide.esRight}i.BottomPt=null;if(n==r){if(r.FirstLeft!=i)i.FirstLeft=r.FirstLeft;i.IsHole=r.IsHole}r.Pts=null;r.BottomPt=null;r.FirstLeft=i;var p=t.OutIdx;var f=e.OutIdx;t.OutIdx=-1;e.OutIdx=-1;var d=this.m_ActiveEdges;while(d!==null){if(d.OutIdx==f){d.OutIdx=p;d.Side=u;break}d=d.NextInAEL}r.Idx=i.Idx};o.Clipper.prototype.ReversePolyPtLinks=function(t){if(t===null)return;var e;var i;e=t;do{i=e.Next;e.Next=e.Prev;e.Prev=i
;e=i}while(e!=t)};o.Clipper.SwapSides=function(t,e){var i=t.Side;t.Side=e.Side;e.Side=i};o.Clipper.SwapPolyIndexes=function(t,e){var i=t.OutIdx;t.OutIdx=e.OutIdx;e.OutIdx=i};o.Clipper.prototype.IntersectEdges=function(t,e,i,r){var s=!r&&t.NextInLML===null&&t.Top.X==i.X&&t.Top.Y==i.Y;var l=!r&&e.NextInLML===null&&e.Top.X==i.X&&e.Top.Y==i.Y;var a=t.OutIdx>=0;var h=e.OutIdx>=0;if(n){if(t.WindDelta===0||e.WindDelta===0){if(t.WindDelta===0&&e.WindDelta===0){if((s||l)&&a&&h)this.AddLocalMaxPoly(t,e,i)}else if(t.PolyTyp==e.PolyTyp&&t.WindDelta!=e.WindDelta&&this.m_ClipType==o.ClipType.ctUnion){if(t.WindDelta===0){if(h){this.AddOutPt(t,i);if(a)t.OutIdx=-1}}else{if(a){this.AddOutPt(e,i);if(h)e.OutIdx=-1}}}else if(t.PolyTyp!=e.PolyTyp){if(t.WindDelta===0&&Math.abs(e.WindCnt)==1&&(this.m_ClipType!=o.ClipType.ctUnion||e.WindCnt2===0)){this.AddOutPt(t,i);if(a)t.OutIdx=-1}else if(e.WindDelta===0&&Math.abs(t.WindCnt)==1&&(this.m_ClipType!=o.ClipType.ctUnion||t.WindCnt2===0)){this.AddOutPt(e,i);if(h)e.OutIdx=-1}}if(s)if(t.OutIdx<0)this.DeleteFromAEL(t);else o.Error("Error intersecting polylines");if(l)if(e.OutIdx<0)this.DeleteFromAEL(e);else o.Error("Error intersecting polylines");return}}if(t.PolyTyp==e.PolyTyp){if(this.IsEvenOddFillType(t)){var u=t.WindCnt;t.WindCnt=e.WindCnt;e.WindCnt=u}else{if(t.WindCnt+e.WindDelta===0)t.WindCnt=-t.WindCnt;else t.WindCnt+=e.WindDelta;if(e.WindCnt-t.WindDelta===0)e.WindCnt=-e.WindCnt;else e.WindCnt-=t.WindDelta}}else{if(!this.IsEvenOddFillType(e))t.WindCnt2+=e.WindDelta;else t.WindCnt2=t.WindCnt2===0?1:0;if(!this.IsEvenOddFillType(t))e.WindCnt2-=t.WindDelta;else e.WindCnt2=e.WindCnt2===0?1:0}var p,f,d,v;if(t.PolyTyp==o.PolyType.ptSubject){p=this.m_SubjFillType;d=this.m_ClipFillType}else{p=this.m_ClipFillType;d=this.m_SubjFillType}if(e.PolyTyp==o.PolyType.ptSubject){f=this.m_SubjFillType;v=this.m_ClipFillType}else{f=this.m_ClipFillType;v=this.m_SubjFillType}var c,P;switch(p){case o.PolyFillType.pftPositive:c=t.WindCnt;break;case o.PolyFillType.pftNegative:c=-t.WindCnt;break;default:c=Math.abs(t.WindCnt);break}switch(f){case o.PolyFillType.pftPositive:P=e.WindCnt;break;case o.PolyFillType.pftNegative:P=-e.WindCnt;break;default:P=Math.abs(e.WindCnt);break}if(a&&h){if(s||l||c!==0&&c!=1||P!==0&&P!=1||t.PolyTyp!=e.PolyTyp&&this.m_ClipType!=o.ClipType.ctXor)this.AddLocalMaxPoly(t,e,i);else{this.AddOutPt(t,i);this.AddOutPt(e,i);o.Clipper.SwapSides(t,e);o.Clipper.SwapPolyIndexes(t,e)}}else if(a){if(P===0||P==1){this.AddOutPt(t,i);o.Clipper.SwapSides(t,e);o.Clipper.SwapPolyIndexes(t,e)}}else if(h){if(c===0||c==1){this.AddOutPt(e,i);o.Clipper.SwapSides(t,e);o.Clipper.SwapPolyIndexes(t,e)}}else if((c===0||c==1)&&(P===0||P==1)&&!s&&!l){var m,y;switch(d){case o.PolyFillType.pftPositive:m=t.WindCnt2;break;case o.PolyFillType.pftNegative:m=-t.WindCnt2;break;default:m=Math.abs(t.WindCnt2);break}switch(v){case o.PolyFillType.pftPositive:y=e.WindCnt2;break;case o.PolyFillType.pftNegative:y=-e.WindCnt2;break;default:y=Math.abs(e.WindCnt2);break}if(t.PolyTyp!=e.PolyTyp)this.AddLocalMinPoly(t,e,i);else if(c==1&&P==1)switch(this.m_ClipType){case o.ClipType.ctIntersection:if(m>0&&y>0)this.AddLocalMinPoly(t,e,i);break;case o.ClipType.ctUnion:if(m<=0&&y<=0)this.AddLocalMinPoly(t,e,i);break;case o.ClipType.ctDifference:if(t.PolyTyp==o.PolyType.ptClip&&m>0&&y>0||t.PolyTyp==o.PolyType.ptSubject&&m<=0&&y<=0)this.AddLocalMinPoly(t,e,i);break;case o.ClipType.ctXor:this.AddLocalMinPoly(t,e,i);break}else o.Clipper.SwapSides(t,e)}if(s!=l&&(s&&t.OutIdx>=0||l&&e.OutIdx>=0)){o.Clipper.SwapSides(t,e);o.Clipper.SwapPolyIndexes(t,e)}if(s)this.DeleteFromAEL(t);if(l)this.DeleteFromAEL(e)};o.Clipper.prototype.DeleteFromAEL=function(t){var e=t.PrevInAEL;var i=t.NextInAEL;if(e===null&&i===null&&t!=this.m_ActiveEdges)return;if(e!==null)e.NextInAEL=i;else this.m_ActiveEdges=i;if(i!==null)i.PrevInAEL=e;t.NextInAEL=null;t.PrevInAEL=null};o.Clipper.prototype.DeleteFromSEL=function(t){var e=t.PrevInSEL;var i=t.NextInSEL;if(e===null&&i===null&&t!=this.m_SortedEdges)return;if(e!==null)e.NextInSEL=i;else this.m_SortedEdges=i;if(i!==null)i.PrevInSEL=e;t.NextInSEL=null;t.PrevInSEL=null};o.Clipper.prototype.UpdateEdgeIntoAEL=function(t){if(t.NextInLML===null)o.Error("UpdateEdgeIntoAEL: invalid call");var e=t.PrevInAEL;var i=t.NextInAEL;t.NextInLML.OutIdx=t.OutIdx;if(e!==null)e.NextInAEL=t.NextInLML;else this.m_ActiveEdges=t.NextInLML;if(i!==null)i.PrevInAEL=t.NextInLML;t.NextInLML.Side=t.Side;t.NextInLML.WindDelta=t.WindDelta;t.NextInLML.WindCnt=t.WindCnt;t.NextInLML.WindCnt2=t.WindCnt2;t=t.NextInLML;t.Curr.X=t.Bot.X;t.Curr.Y=t.Bot.Y;t.PrevInAEL=e;t.NextInAEL=i;if(!o.ClipperBase.IsHorizontal(t))this.InsertScanbeam(t.Top.Y);return t};o.Clipper.prototype.ProcessHorizontals=function(t){var e=this.m_SortedEdges;while(e!==null){this.DeleteFromSEL(e);this.ProcessHorizontal(e,t);e=this.m_SortedEdges}};o.Clipper.prototype.GetHorzDirection=function(t,e){if(t.Bot.X<t.Top.X){e.Left=t.Bot.X;e.Right=t.Top.X;e.Dir=o.Direction.dLeftToRight}else{e.Left=t.Top.X;e.Right=t.Bot.X;e.Dir=o.Direction.dRightToLeft}};o.Clipper.prototype.PrepareHorzJoins=function(t,e){var i=this.m_PolyOuts[t.OutIdx].Pts;if(t.Side!=o.EdgeSide.esLeft)i=i.Prev;if(e)if(o.IntPoint.op_Equality(i.Pt,t.Top))this.AddGhostJoin(i,t.Bot);else this.AddGhostJoin(i,t.Top)};o.Clipper.prototype.ProcessHorizontal=function(t,e){var i={Dir:null,Left:null,Right:null};this.GetHorzDirection(t,i);var r=i.Dir;var n=i.Left;var s=i.Right;var l=t,a=null;while(l.NextInLML!==null&&o.ClipperBase.IsHorizontal(l.NextInLML))l=l.NextInLML;if(l.NextInLML===null)a=this.GetMaximaPair(l);for(;;){var h=t==l;var u=this.GetNextInAEL(t,r);while(u!==null){if(u.Curr.X==t.Top.X&&t.NextInLML!==null&&u.Dx<t.NextInLML.Dx)break;var p=this.GetNextInAEL(u,r);if(r==o.Direction.dLeftToRight&&u.Curr.X<=s||r==o.Direction.dRightToLeft&&u.Curr.X>=n){if(t.OutIdx>=0&&t.WindDelta!=0)this.PrepareHorzJoins(t,e);if(u==a&&h){if(r==o.Direction.dLeftToRight)this.IntersectEdges(t,u,u.Top,false);else this.IntersectEdges(u,t,u.Top,false);if(a.OutIdx>=0)o.Error("ProcessHorizontal error");return}else if(r==o.Direction.dLeftToRight){var f=new o.IntPoint(u.Curr.X,t.Curr.Y);this.IntersectEdges(t,u,f,true)}else{var f=new o.IntPoint(u.Curr.X,t.Curr.Y);this.IntersectEdges(u,t,f,true)}this.SwapPositionsInAEL(t,u)}else if(r==o.Direction.dLeftToRight&&u.Curr.X>=s||r==o.Direction.dRightToLeft&&u.Curr.X<=n)break;u=p}if(t.OutIdx>=0&&t.WindDelta!==0)this.PrepareHorzJoins(t,e);if(t.NextInLML!==null&&o.ClipperBase.IsHorizontal(t.NextInLML)){t=this.UpdateEdgeIntoAEL(t);if(t.OutIdx>=0)this.AddOutPt(t,t.Bot);var i={Dir:r,Left:n,Right:s};this.GetHorzDirection(t,i);r=i.Dir;n=i.Left;s=i.Right}else break}if(t.NextInLML!==null){if(t.OutIdx>=0){var d=this.AddOutPt(t,t.Top);t=this.UpdateEdgeIntoAEL(t);if(t.WindDelta===0)return;var v=t.PrevInAEL;var p=t.NextInAEL;if(v!==null&&v.Curr.X==t.Bot.X&&v.Curr.Y==t.Bot.Y&&v.WindDelta!==0&&(v.OutIdx>=0&&v.Curr.Y>v.Top.Y&&o.ClipperBase.SlopesEqual(t,v,this.m_UseFullRange))){var c=this.AddOutPt(v,t.Bot);this.AddJoin(d,c,t.Top)}else if(p!==null&&p.Curr.X==t.Bot.X&&p.Curr.Y==t.Bot.Y&&p.WindDelta!==0&&p.OutIdx>=0&&p.Curr.Y>p.Top.Y&&o.ClipperBase.SlopesEqual(t,p,this.m_UseFullRange)){var c=this.AddOutPt(p,t.Bot);this.AddJoin(d,c,t.Top)}}else t=this.UpdateEdgeIntoAEL(t)}else if(a!==null){if(a.OutIdx>=0){if(r==o.Direction.dLeftToRight)this.IntersectEdges(t,a,t.Top,false);else this.IntersectEdges(a,t,t.Top,false);if(a.OutIdx>=0)o.Error("ProcessHorizontal error")}else{this.DeleteFromAEL(t);this.DeleteFromAEL(a)}}else{if(t.OutIdx>=0)this.AddOutPt(t,t.Top);this.DeleteFromAEL(t)}};o.Clipper.prototype.GetNextInAEL=function(t,e){return e==o.Direction.dLeftToRight?t.NextInAEL:t.PrevInAEL};o.Clipper.prototype.IsMinima=function(t){return t!==null&&t.Prev.NextInLML!=t&&t.Next.NextInLML!=t};o.Clipper.prototype.IsMaxima=function(t,e){return t!==null&&t.Top.Y==e&&t.NextInLML===null};o.Clipper.prototype.IsIntermediate=function(t,e){return t.Top.Y==e&&t.NextInLML!==null};o.Clipper.prototype.GetMaximaPair=function(t){var e=null;if(o.IntPoint.op_Equality(t.Next.Top,t.Top)&&t.Next.NextInLML===null)e=t.Next;else if(o.IntPoint.op_Equality(t.Prev.Top,t.Top)&&t.Prev.NextInLML===null)e=t.Prev;if(e!==null&&(e.OutIdx==-2||e.NextInAEL==e.PrevInAEL&&!o.ClipperBase.IsHorizontal(e)))return null;return e};o.Clipper.prototype.ProcessIntersections=function(t,e){if(this.m_ActiveEdges==null)return true;try{this.BuildIntersectList(t,e);if(this.m_IntersectList.length==0)return true;if(this.m_IntersectList.length==1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return false}catch(t){this.m_SortedEdges=null;this.m_IntersectList.length=0;o.Error("ProcessIntersections error")}this.m_SortedEdges=null;return true};o.Clipper.prototype.BuildIntersectList=function(t,e){if(this.m_ActiveEdges===null)return;var i=this.m_ActiveEdges;this.m_SortedEdges=i;while(i!==null){i.PrevInSEL=i.PrevInAEL;i.NextInSEL=i.NextInAEL;i.Curr.X=o.Clipper.TopX(i,e);i=i.NextInAEL}var r=true;while(r&&this.m_SortedEdges!==null){r=false;i=this.m_SortedEdges;while(i.NextInSEL!==null){var n=i.NextInSEL;var s=new o.IntPoint;if(i.Curr.X>n.Curr.X){if(!this.IntersectPoint(i,n,s)&&i.Curr.X>n.Curr.X+1){o.Error("Intersection error")}if(s.Y>t){s.Y=t;if(Math.abs(i.Dx)>Math.abs(n.Dx))s.X=o.Clipper.TopX(n,t);else s.X=o.Clipper.TopX(i,t)}var l=new o.IntersectNode;l.Edge1=i;l.Edge2=n;l.Pt.X=s.X;l.Pt.Y=s.Y;this.m_IntersectList.push(l);this.SwapPositionsInSEL(i,n);r=true}else i=n}if(i.PrevInSEL!==null)i.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null};o.Clipper.prototype.EdgesAdjacent=function(t){return t.Edge1.NextInSEL==t.Edge2||t.Edge1.PrevInSEL==t.Edge2};o.Clipper.IntersectNodeSort=function(t,e){return e.Pt.Y-t.Pt.Y};o.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();var t=this.m_IntersectList.length;for(var e=0;e<t;e++){if(!this.EdgesAdjacent(this.m_IntersectList[e])){var i=e+1;while(i<t&&!this.EdgesAdjacent(this.m_IntersectList[i]))i++;if(i==t)return false;var r=this.m_IntersectList[e];this.m_IntersectList[e]=this.m_IntersectList[i];this.m_IntersectList[i]=r}this.SwapPositionsInSEL(this.m_IntersectList[e].Edge1,this.m_IntersectList[e].Edge2)}return true};o.Clipper.prototype.ProcessIntersectList=function(){for(var t=0,e=this.m_IntersectList.length;t<e;t++){var i=this.m_IntersectList[t];this.IntersectEdges(i.Edge1,i.Edge2,i.Pt,true);this.SwapPositionsInAEL(i.Edge1,i.Edge2)}this.m_IntersectList.length=0};var xe=function(t){return t<0?Math.ceil(t-.5):Math.round(t)};var _e=function(t){return t<0?Math.ceil(t-.5):Math.floor(t+.5)};var Ie=function(t){return t<0?-Math.round(Math.abs(t)):Math.round(t)};var Ee=function(t){if(t<0){t-=.5;return t<-2147483648?Math.ceil(t):t|0}else{t+=.5;return t>2147483647?Math.floor(t):t|0}};if(u.msie)o.Clipper.Round=xe;else if(u.chromium)o.Clipper.Round=Ie;else if(u.safari)o.Clipper.Round=Ee;else o.Clipper.Round=_e;o.Clipper.TopX=function(t,e){if(e==t.Top.Y)return t.Top.X;return t.Bot.X+o.Clipper.Round(t.Dx*(e-t.Bot.Y))};o.Clipper.prototype.IntersectPoint=function(t,e,i){i.X=0;i.Y=0;var r,n;if(o.ClipperBase.SlopesEqual(t,e,this.m_UseFullRange)||t.Dx==e.Dx){if(e.Bot.Y>t.Bot.Y){i.X=e.Bot.X;i.Y=e.Bot.Y}else{i.X=t.Bot.X;i.Y=t.Bot.Y}return false}else if(t.Delta.X===0){i.X=t.Bot.X;if(o.ClipperBase.IsHorizontal(e)){i.Y=e.Bot.Y}else{n=e.Bot.Y-e.Bot.X/e.Dx;i.Y=o.Clipper.Round(i.X/e.Dx+n)}}else if(e.Delta.X===0){i.X=e.Bot.X;if(o.ClipperBase.IsHorizontal(t)){i.Y=t.Bot.Y}else{r=t.Bot.Y-t.Bot.X/t.Dx;i.Y=o.Clipper.Round(i.X/t.Dx+r)}}else{r=t.Bot.X-t.Bot.Y*t.Dx;n=e.Bot.X-e.Bot.Y*e.Dx;var s=(n-r)/(t.Dx-e.Dx);i.Y=o.Clipper.Round(s);if(Math.abs(t.Dx)<Math.abs(e.Dx))i.X=o.Clipper.Round(t.Dx*s+r);else i.X=o.Clipper.Round(e.Dx*s+n)}if(i.Y<t.Top.Y||i.Y<e.Top.Y){if(t.Top.Y>e.Top.Y){i.Y=t.Top.Y;i.X=o.Clipper.TopX(e,t.Top.Y);return i.X<t.Top.X}else i.Y=e.Top.Y;if(Math.abs(t.Dx)<Math.abs(e.Dx))i.X=o.Clipper.TopX(t,i.Y);else i.X=o.Clipper.TopX(e,i.Y)}return true};o.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(t){var e=this.m_ActiveEdges;while(e!==null){var i=this.IsMaxima(e,t);if(i){var r=this.GetMaximaPair(e);i=r===null||!o.ClipperBase.IsHorizontal(r)}if(i){var n=e.PrevInAEL;this.DoMaxima(e);if(n===null)e=this.m_ActiveEdges;else e=n.NextInAEL}else{if(this.IsIntermediate(e,t)&&o.ClipperBase.IsHorizontal(e.NextInLML)){e=this.UpdateEdgeIntoAEL(e);if(e.OutIdx>=0)this.AddOutPt(e,e.Bot);this.AddEdgeToSEL(e)}else{e.Curr.X=o.Clipper.TopX(e,t);e.Curr.Y=t}if(this.StrictlySimple){var n=e.PrevInAEL;if(e.OutIdx>=0&&e.WindDelta!==0&&n!==null&&n.OutIdx>=0&&n.Curr.X==e.Curr.X&&n.WindDelta!==0){var s=this.AddOutPt(n,e.Curr);var l=this.AddOutPt(e,e.Curr);this.AddJoin(s,l,e.Curr)}}e=e.NextInAEL}}this.ProcessHorizontals(true);e=this.m_ActiveEdges;while(e!==null){if(this.IsIntermediate(e,t)){var s=null;if(e.OutIdx>=0)s=this.AddOutPt(e,e.Top);e=this.UpdateEdgeIntoAEL(e);var n=e.PrevInAEL;var a=e.NextInAEL;if(n!==null&&n.Curr.X==e.Bot.X&&n.Curr.Y==e.Bot.Y&&s!==null&&n.OutIdx>=0&&n.Curr.Y>n.Top.Y&&o.ClipperBase.SlopesEqual(e,n,this.m_UseFullRange)&&e.WindDelta!==0&&n.WindDelta!==0){var l=this.AddOutPt(n,e.Bot);this.AddJoin(s,l,e.Top)}else if(a!==null&&a.Curr.X==e.Bot.X&&a.Curr.Y==e.Bot.Y&&s!==null&&a.OutIdx>=0&&a.Curr.Y>a.Top.Y&&o.ClipperBase.SlopesEqual(e,a,this.m_UseFullRange)&&e.WindDelta!==0&&a.WindDelta!==0){var l=this.AddOutPt(a,e.Bot);this.AddJoin(s,l,e.Top)}}e=e.NextInAEL}};o.Clipper.prototype.DoMaxima=function(t){var e=this.GetMaximaPair(t);if(e===null){if(t.OutIdx>=0)this.AddOutPt(t,t.Top);this.DeleteFromAEL(t);return}var i=t.NextInAEL;var r=true;while(i!==null&&i!=e){this.IntersectEdges(t,i,t.Top,true);this.SwapPositionsInAEL(t,i);i=t.NextInAEL}if(t.OutIdx==-1&&e.OutIdx==-1){this.DeleteFromAEL(t);this.DeleteFromAEL(e)}else if(t.OutIdx>=0&&e.OutIdx>=0){this.IntersectEdges(t,e,t.Top,false)}else if(r&&t.WindDelta===0){if(t.OutIdx>=0){this.AddOutPt(t,t.Top);t.OutIdx=-1}this.DeleteFromAEL(t);if(e.OutIdx>=0){this.AddOutPt(e,t.Top);e.OutIdx=-1}this.DeleteFromAEL(e)}else o.Error("DoMaxima error")};o.Clipper.ReversePaths=function(t){for(var e=0,i=t.length;e<i;e++)t[e].reverse()};o.Clipper.Orientation=function(t){return o.Clipper.Area(t)>=0};o.Clipper.prototype.PointCount=function(t){if(t===null)return 0;var e=0;var i=t;do{e++;i=i.Next}while(i!=t);return e};o.Clipper.prototype.BuildResult=function(t){o.Clear(t);for(var e=0,i=this.m_PolyOuts.length;e<i;e++){var r=this.m_PolyOuts[e];if(r.Pts===null)continue;var n=r.Pts.Prev;var s=this.PointCount(n);if(s<2)continue;var l=new Array(s);for(var a=0;a<s;a++){l[a]=n.Pt;n=n.Prev}t.push(l)}};o.Clipper.prototype.BuildResult2=function(t){t.Clear();for(var e=0,i=this.m_PolyOuts.length;e<i;e++){var r=this.m_PolyOuts[e];var n=this.PointCount(r.Pts);if(r.IsOpen&&n<2||!r.IsOpen&&n<3)continue;this.FixHoleLinkage(r);var s=new o.PolyNode;t.m_AllPolys.push(s);r.PolyNode=s;s.m_polygon.length=n;var l=r.Pts.Prev;for(var a=0;a<n;a++){s.m_polygon[a]=l.Pt;l=l.Prev}}for(var e=0,i=this.m_PolyOuts.length;e<i;e++){var r=this.m_PolyOuts[e];if(r.PolyNode===null)continue;else if(r.IsOpen){r.PolyNode.IsOpen=true;t.AddChild(r.PolyNode)}else if(r.FirstLeft!==null&&r.FirstLeft.PolyNode!=null)r.FirstLeft.PolyNode.AddChild(r.PolyNode);else t.AddChild(r.PolyNode)}};o.Clipper.prototype.FixupOutPolygon=function(t){var e=null;t.BottomPt=null;var i=t.Pts;for(;;){if(i.Prev==i||i.Prev==i.Next){this.DisposeOutPts(i);t.Pts=null;return}if(o.IntPoint.op_Equality(i.Pt,i.Next.Pt)||o.IntPoint.op_Equality(i.Pt,i.Prev.Pt)||o.ClipperBase.SlopesEqual(i.Prev.Pt,i.Pt,i.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(i.Prev.Pt,i.Pt,i.Next.Pt))){e=null;var r=i;i.Prev.Next=i.Next;i.Next.Prev=i.Prev;i=i.Prev;r=null}else if(i==e)break;else{if(e===null)e=i;i=i.Next}}t.Pts=i};o.Clipper.prototype.DupOutPt=function(t,e){var i=new o.OutPt;i.Pt.X=t.Pt.X;i.Pt.Y=t.Pt.Y;i.Idx=t.Idx;if(e){i.Next=t.Next;i.Prev=t;t.Next.Prev=i;t.Next=i}else{i.Prev=t.Prev;i.Next=t;t.Prev.Next=i;t.Prev=i}return i};o.Clipper.prototype.GetOverlap=function(t,e,i,r,n){if(t<e){if(i<r){n.Left=Math.max(t,i);n.Right=Math.min(e,r)}else{n.Left=Math.max(t,r);n.Right=Math.min(e,i)}}else{if(i<r){n.Left=Math.max(e,i);n.Right=Math.min(t,r)}else{n.Left=Math.max(e,r);n.Right=Math.min(t,i)}}return n.Left<n.Right};o.Clipper.prototype.JoinHorz=function(t,e,i,r,n,s){var l=t.Pt.X>e.Pt.X?o.Direction.dRightToLeft:o.Direction.dLeftToRight;var a=i.Pt.X>r.Pt.X?o.Direction.dRightToLeft:o.Direction.dLeftToRight;if(l==a)return false;if(l==o.Direction.dLeftToRight){while(t.Next.Pt.X<=n.X&&t.Next.Pt.X>=t.Pt.X&&t.Next.Pt.Y==n.Y)t=t.Next;if(s&&t.Pt.X!=n.X)t=t.Next;e=this.DupOutPt(t,!s);if(o.IntPoint.op_Inequality(e.Pt,n)){t=e;t.Pt.X=n.X;t.Pt.Y=n.Y;e=this.DupOutPt(t,!s)}}else{while(t.Next.Pt.X>=n.X&&t.Next.Pt.X<=t.Pt.X&&t.Next.Pt.Y==n.Y)t=t.Next;if(!s&&t.Pt.X!=n.X)t=t.Next;e=this.DupOutPt(t,s);if(o.IntPoint.op_Inequality(e.Pt,n)){t=e;t.Pt.X=n.X;t.Pt.Y=n.Y;e=this.DupOutPt(t,s)}}if(a==o.Direction.dLeftToRight){while(i.Next.Pt.X<=n.X&&i.Next.Pt.X>=i.Pt.X&&i.Next.Pt.Y==n.Y)i=i.Next;if(s&&i.Pt.X!=n.X)i=i.Next;r=this.DupOutPt(i,!s);if(o.IntPoint.op_Inequality(r.Pt,n)){i=r;i.Pt.X=n.X;i.Pt.Y=n.Y;r=this.DupOutPt(i,!s)}}else{while(i.Next.Pt.X>=n.X&&i.Next.Pt.X<=i.Pt.X&&i.Next.Pt.Y==n.Y)i=i.Next;if(!s&&i.Pt.X!=n.X)i=i.Next;r=this.DupOutPt(i,s);if(o.IntPoint.op_Inequality(r.Pt,n)){i=r;i.Pt.X=n.X;i.Pt.Y=n.Y;r=this.DupOutPt(i,s)}}if(l==o.Direction.dLeftToRight==s){t.Prev=i;i.Next=t;e.Next=r;r.Prev=e}else{t.Next=i;i.Prev=t;e.Prev=r;r.Next=e}return true};o.Clipper.prototype.JoinPoints=function(t,e,i){var r=t.OutPt1,n=new o.OutPt;var s=t.OutPt2,l=new o.OutPt;var a=t.OutPt1.Pt.Y==t.OffPt.Y;if(a&&o.IntPoint.op_Equality(t.OffPt,t.OutPt1.Pt)&&o.IntPoint.op_Equality(t.OffPt,t.OutPt2.Pt)){n=t.OutPt1.Next;while(n!=r&&o.IntPoint.op_Equality(n.Pt,t.OffPt))n=n.Next;var h=n.Pt.Y>t.OffPt.Y;l=t.OutPt2.Next;while(l!=s&&o.IntPoint.op_Equality(l.Pt,t.OffPt))l=l.Next;var u=l.Pt.Y>t.OffPt.Y;if(h==u)return false;if(h){n=this.DupOutPt(r,false);l=this.DupOutPt(s,true);r.Prev=s;s.Next=r;n.Next=l;l.Prev=n;t.OutPt1=r;t.OutPt2=n;return true}else{n=this.DupOutPt(r,true);l=this.DupOutPt(s,false);r.Next=s;s.Prev=r;n.Prev=l;l.Next=n;t.OutPt1=r;t.OutPt2=n;return true}}else if(a){n=r;while(r.Prev.Pt.Y==r.Pt.Y&&r.Prev!=n&&r.Prev!=s)r=r.Prev;while(n.Next.Pt.Y==n.Pt.Y&&n.Next!=r&&n.Next!=s)n=n.Next;if(n.Next==r||n.Next==s)return false;l=s;while(s.Prev.Pt.Y==s.Pt.Y&&s.Prev!=l&&s.Prev!=n)s=s.Prev;while(l.Next.Pt.Y==l.Pt.Y&&l.Next!=s&&l.Next!=r)l=l.Next;if(l.Next==s||l.Next==r)return false;var p={Left:null,Right:null};if(!this.GetOverlap(r.Pt.X,n.Pt.X,s.Pt.X,l.Pt.X,p))return false;var f=p.Left;var d=p.Right;var v=new o.IntPoint;var c;if(r.Pt.X>=f&&r.Pt.X<=d){v.X=r.Pt.X;v.Y=r.Pt.Y;c=r.Pt.X>n.Pt.X}else if(s.Pt.X>=f&&s.Pt.X<=d){v.X=s.Pt.X;v.Y=s.Pt.Y;c=s.Pt.X>l.Pt.X}else if(n.Pt.X>=f&&n.Pt.X<=d){v.X=n.Pt.X;v.Y=n.Pt.Y;c=n.Pt.X>r.Pt.X}else{v.X=l.Pt.X;v.Y=l.Pt.Y;c=l.Pt.X>s.Pt.X}t.OutPt1=r;t.OutPt2=s;return this.JoinHorz(r,n,s,l,v,c)}else{n=r.Next;while(o.IntPoint.op_Equality(n.Pt,r.Pt)&&n!=r)n=n.Next;var P=n.Pt.Y>r.Pt.Y||!o.ClipperBase.SlopesEqual(r.Pt,n.Pt,t.OffPt,this.m_UseFullRange);if(P){n=r.Prev;while(o.IntPoint.op_Equality(n.Pt,r.Pt)&&n!=r)n=n.Prev;if(n.Pt.Y>r.Pt.Y||!o.ClipperBase.SlopesEqual(r.Pt,n.Pt,t.OffPt,this.m_UseFullRange))return false}l=s.Next;while(o.IntPoint.op_Equality(l.Pt,s.Pt)&&l!=s)l=l.Next;var m=l.Pt.Y>s.Pt.Y||!o.ClipperBase.SlopesEqual(s.Pt,l.Pt,t.OffPt,this.m_UseFullRange);if(m){l=s.Prev;while(o.IntPoint.op_Equality(l.Pt,s.Pt)&&l!=s)l=l.Prev;if(l.Pt.Y>s.Pt.Y||!o.ClipperBase.SlopesEqual(s.Pt,l.Pt,t.OffPt,this.m_UseFullRange))return false}if(n==r||l==s||n==l||e==i&&P==m)return false;if(P){n=this.DupOutPt(r,false);l=this.DupOutPt(s,true);r.Prev=s;s.Next=r;n.Next=l;l.Prev=n;t.OutPt1=r;t.OutPt2=n;return true}else{n=this.DupOutPt(r,true);l=this.DupOutPt(s,false);r.Next=s;s.Prev=r;n.Prev=l;l.Next=n;t.OutPt1=r;t.OutPt2=n;return true}}};o.Clipper.GetBounds=function(t){var e=0,i=t.length;while(e<i&&t[e].length==0)e++;if(e==i)return new o.IntRect(0,0,0,0);var r=new o.IntRect;r.left=t[e][0].X;r.right=r.left;r.top=t[e][0].Y;r.bottom=r.top;for(;e<i;e++)for(var n=0,s=t[e].length;n<s;n++){if(t[e][n].X<r.left)r.left=t[e][n].X;else if(t[e][n].X>r.right)r.right=t[e][n].X;if(t[e][n].Y<r.top)r.top=t[e][n].Y;else if(t[e][n].Y>r.bottom)r.bottom=t[e][n].Y}return r};o.Clipper.prototype.GetBounds2=function(t){var e=t;var i=new o.IntRect;i.left=t.Pt.X;i.right=t.Pt.X;i.top=t.Pt.Y;i.bottom=t.Pt.Y;t=t.Next;while(t!=e){if(t.Pt.X<i.left)i.left=t.Pt.X;if(t.Pt.X>i.right)i.right=t.Pt.X;if(t.Pt.Y<i.top)i.top=t.Pt.Y;if(t.Pt.Y>i.bottom)i.bottom=t.Pt.Y;t=t.Next}return i};o.Clipper.PointInPolygon=function(t,e){var i=0,r=e.length;if(r<3)return 0;var n=e[0];for(var s=1;s<=r;++s){var o=s==r?e[0]:e[s];if(o.Y==t.Y){if(o.X==t.X||n.Y==t.Y&&o.X>t.X==n.X<t.X)return-1}if(n.Y<t.Y!=o.Y<t.Y){if(n.X>=t.X){if(o.X>t.X)i=1-i;else{var l=(n.X-t.X)*(o.Y-t.Y)-(o.X-t.X)*(n.Y-t.Y);if(l==0)return-1;else if(l>0==o.Y>n.Y)i=1-i}}else{if(o.X>t.X){var l=(n.X-t.X)*(o.Y-t.Y)-(o.X-t.X)*(n.Y-t.Y);if(l==0)return-1;else if(l>0==o.Y>n.Y)i=1-i}}}n=o}return i};o.Clipper.prototype.PointInPolygon=function(t,e){var i=0;var r=e;for(;;){var n=e.Pt.X,s=e.Pt.Y;var o=e.Next.Pt.X,l=e.Next.Pt.Y;if(l==t.Y){if(o==t.X||s==t.Y&&o>t.X==n<t.X)return-1}if(s<t.Y!=l<t.Y){if(n>=t.X){if(o>t.X)i=1-i;else{var a=(n-t.X)*(l-t.Y)-(o-t.X)*(s-t.Y);if(a==0)return-1;if(a>0==l>s)i=1-i}}else{if(o>t.X){var a=(n-t.X)*(l-t.Y)-(o-t.X)*(s-t.Y);if(a==0)return-1;if(a>0==l>s)i=1-i}}}e=e.Next;if(r==e)break}return i};o.Clipper.prototype.Poly2ContainsPoly1=function(t,e){var i=t;do{var r=this.PointInPolygon(i.Pt,e);if(r>=0)return r!=0;i=i.Next}while(i!=t);return true};o.Clipper.prototype.FixupFirstLefts1=function(t,e){for(var i=0,r=this.m_PolyOuts.length;i<r;i++){var n=this.m_PolyOuts[i];if(n.Pts!==null&&n.FirstLeft==t){if(this.Poly2ContainsPoly1(n.Pts,e.Pts))n.FirstLeft=e}}};o.Clipper.prototype.FixupFirstLefts2=function(t,e){for(var i=0,r=this.m_PolyOuts,n=r.length,s=r[i];i<n;i++,s=r[i])if(s.FirstLeft==t)s.FirstLeft=e};o.Clipper.ParseFirstLeft=function(t){while(t!=null&&t.Pts==null)t=t.FirstLeft;return t};o.Clipper.prototype.JoinCommonEdges=function(){for(var t=0,e=this.m_Joins.length;t<e;t++){var i=this.m_Joins[t];var r=this.GetOutRec(i.OutPt1.Idx);var n=this.GetOutRec(i.OutPt2.Idx);if(r.Pts==null||n.Pts==null)continue;var s;if(r==n)s=r;else if(this.Param1RightOfParam2(r,n))s=n;else if(this.Param1RightOfParam2(n,r))s=r;else s=this.GetLowermostRec(r,n);if(!this.JoinPoints(i,r,n))continue;if(r==n){r.Pts=i.OutPt1;r.BottomPt=null;n=this.CreateOutRec();n.Pts=i.OutPt2;this.UpdateOutPtIdxs(n);if(this.m_UsingPolyTree)for(var l=0,a=this.m_PolyOuts.length;l<a-1;l++){var h=this.m_PolyOuts[l];if(h.Pts==null||o.Clipper.ParseFirstLeft(h.FirstLeft)!=r||h.IsHole==r.IsHole)continue;if(this.Poly2ContainsPoly1(h.Pts,i.OutPt2))h.FirstLeft=n}if(this.Poly2ContainsPoly1(n.Pts,r.Pts)){n.IsHole=!r.IsHole;n.FirstLeft=r;if(this.m_UsingPolyTree)this.FixupFirstLefts2(n,r);if((n.IsHole^this.ReverseSolution)==this.Area(n)>0)this.ReversePolyPtLinks(n.Pts)}else if(this.Poly2ContainsPoly1(r.Pts,n.Pts)){n.IsHole=r.IsHole;r.IsHole=!n.IsHole;n.FirstLeft=r.FirstLeft;r.FirstLeft=n;if(this.m_UsingPolyTree)this.FixupFirstLefts2(r,n);if((r.IsHole^this.ReverseSolution)==this.Area(r)>0)this.ReversePolyPtLinks(r.Pts)}else{n.IsHole=r.IsHole;n.FirstLeft=r.FirstLeft;if(this.m_UsingPolyTree)this.FixupFirstLefts1(r,n)}}else{n.Pts=null;n.BottomPt=null;n.Idx=r.Idx;r.IsHole=s.IsHole;if(s==n)r.FirstLeft=n.FirstLeft;n.FirstLeft=r;if(this.m_UsingPolyTree)this.FixupFirstLefts2(n,r)}}};o.Clipper.prototype.UpdateOutPtIdxs=function(t){var e=t.Pts;do{e.Idx=t.Idx;e=e.Prev}while(e!=t.Pts)};o.Clipper.prototype.DoSimplePolygons=function(){var t=0;while(t<this.m_PolyOuts.length){var e=this.m_PolyOuts[t++];var i=e.Pts;if(i===null)continue;do{var r=i.Next;while(r!=e.Pts){if(o.IntPoint.op_Equality(i.Pt,r.Pt)&&r.Next!=i&&r.Prev!=i){var n=i.Prev;var s=r.Prev;i.Prev=s;s.Next=i;r.Prev=n;n.Next=r;e.Pts=i;var l=this.CreateOutRec();l.Pts=r;this.UpdateOutPtIdxs(l);if(this.Poly2ContainsPoly1(l.Pts,e.Pts)){l.IsHole=!e.IsHole;l.FirstLeft=e}else if(this.Poly2ContainsPoly1(e.Pts,l.Pts)){l.IsHole=e.IsHole;e.IsHole=!l.IsHole;l.FirstLeft=e.FirstLeft;e.FirstLeft=l}else{l.IsHole=e.IsHole;l.FirstLeft=e.FirstLeft}r=i}r=r.Next}i=i.Next}while(i!=e.Pts)}};o.Clipper.Area=function(t){var e=t.length;if(e<3)return 0;var i=0;for(var r=0,n=e-1;r<e;++r){i+=(t[n].X+t[r].X)*(t[n].Y-t[r].Y);n=r}return-i*.5};o.Clipper.prototype.Area=function(t){var e=t.Pts;if(e==null)return 0;var i=0;do{i=i+(e.Prev.Pt.X+e.Pt.X)*(e.Prev.Pt.Y-e.Pt.Y);e=e.Next}while(e!=t.Pts);return i*.5};if(s){o.Clipper.OffsetPaths=function(t,e,i,r,n){var s=new o.Paths;var l=new o.ClipperOffset(n,n);l.AddPaths(t,i,r);l.Execute(s,e);return s}}o.Clipper.SimplifyPolygon=function(t,e){var i=new Array;var r=new o.Clipper(0);r.StrictlySimple=true;r.AddPath(t,o.PolyType.ptSubject,true);r.Execute(o.ClipType.ctUnion,i,e,e);return i};o.Clipper.SimplifyPolygons=function(t,e){if(typeof e=="undefined")e=o.PolyFillType.pftEvenOdd;var i=new Array;var r=new o.Clipper(0);r.StrictlySimple=true;r.AddPaths(t,o.PolyType.ptSubject,true);r.Execute(o.ClipType.ctUnion,i,e,e);return i};o.Clipper.DistanceSqrd=function(t,e){var i=t.X-e.X;var r=t.Y-e.Y;return i*i+r*r};o.Clipper.DistanceFromLineSqrd=function(t,e,i){var r=e.Y-i.Y;var n=i.X-e.X;var s=r*e.X+n*e.Y;s=r*t.X+n*t.Y-s;return s*s/(r*r+n*n)};o.Clipper.SlopesNearCollinear=function(t,e,i,r){return o.Clipper.DistanceFromLineSqrd(e,t,i)<r};o.Clipper.PointsAreClose=function(t,e,i){var r=t.X-e.X;var n=t.Y-e.Y;return r*r+n*n<=i};o.Clipper.ExcludeOp=function(t){var e=t.Prev;e.Next=t.Next;t.Next.Prev=e;e.Idx=0;return e};o.Clipper.CleanPolygon=function(t,e){if(typeof e=="undefined")e=1.415;var i=t.length;if(i==0)return new Array;var r=new Array(i);for(var n=0;n<i;++n)r[n]=new o.OutPt;for(var n=0;n<i;++n){r[n].Pt=t[n];r[n].Next=r[(n+1)%i];r[n].Next.Prev=r[n];r[n].Idx=0}var s=e*e;var l=r[0];while(l.Idx==0&&l.Next!=l.Prev){if(o.Clipper.PointsAreClose(l.Pt,l.Prev.Pt,s)){l=o.Clipper.ExcludeOp(l);i--}else if(o.Clipper.PointsAreClose(l.Prev.Pt,l.Next.Pt,s)){o.Clipper.ExcludeOp(l.Next);l=o.Clipper.ExcludeOp(l);i-=2}else if(o.Clipper.SlopesNearCollinear(l.Prev.Pt,l.Pt,l.Next.Pt,s)){l=o.Clipper.ExcludeOp(l);i--}else{l.Idx=1;l=l.Next}}if(i<3)i=0;var a=new Array(i);for(var n=0;n<i;++n){a[n]=new o.IntPoint(l.Pt);l=l.Next}r=null;return a};o.Clipper.CleanPolygons=function(t,e){var i=new Array(t.length);for(var r=0,n=t.length;r<n;r++)i[r]=o.Clipper.CleanPolygon(t[r],e);return i};o.Clipper.Minkowski=function(t,e,i,r){var n=r?1:0;var s=t.length;var l=e.length;var a=new Array;if(i)for(var h=0;h<l;h++){var u=new Array(s);for(var p=0,f=t.length,d=t[p];p<f;p++,d=t[p])u[p]=new o.IntPoint(e[h].X+d.X,e[h].Y+d.Y);a.push(u)}else for(var h=0;h<l;h++){var u=new Array(s);for(var p=0,f=t.length,d=t[p];p<f;p++,d=t[p])u[p]=new o.IntPoint(e[h].X-d.X,e[h].Y-d.Y);a.push(u)}var v=new Array;for(var h=0;h<l-1+n;h++)for(var p=0;p<s;p++){var c=new Array;c.push(a[h%l][p%s]);c.push(a[(h+1)%l][p%s]);c.push(a[(h+1)%l][(p+1)%s]);c.push(a[h%l][(p+1)%s]);if(!o.Clipper.Orientation(c))c.reverse();v.push(c)}var P=new o.Clipper(0);P.AddPaths(v,o.PolyType.ptSubject,true);P.Execute(o.ClipType.ctUnion,a,o.PolyFillType.pftNonZero,o.PolyFillType.pftNonZero);return a};o.Clipper.MinkowskiSum=function(){var t=arguments,e=t.length;if(e==3){var i=t[0],r=t[1],n=t[2];return o.Clipper.Minkowski(i,r,true,n)}else if(e==4){var i=t[0],s=t[1],l=t[2],n=t[3];var a=new o.Clipper,h;for(var u=0,p=s.length;u<p;++u){var h=o.Clipper.Minkowski(i,s[u],true,n);a.AddPaths(h,o.PolyType.ptSubject,true)}if(n)a.AddPaths(s,o.PolyType.ptClip,true);var f=new o.Paths;a.Execute(o.ClipType.ctUnion,f,l,l);return f}};o.Clipper.MinkowskiDiff=function(t,e,i){return o.Clipper.Minkowski(t,e,false,i)};o.Clipper.PolyTreeToPaths=function(t){var e=new Array;o.Clipper.AddPolyNodeToPaths(t,o.Clipper.NodeType.ntAny,e);return e};o.Clipper.AddPolyNodeToPaths=function(t,e,i){var r=true;switch(e){case o.Clipper.NodeType.ntOpen:return;case o.Clipper.NodeType.ntClosed:r=!t.IsOpen;break;default:break}if(t.m_polygon.length>0&&r)i.push(t.m_polygon);for(var n=0,s=t.Childs(),l=s.length,a=s[n];n<l;n++,a=s[n])o.Clipper.AddPolyNodeToPaths(a,e,i)};o.Clipper.OpenPathsFromPolyTree=function(t){var e=new o.Paths;for(var i=0,r=t.ChildCount();i<r;i++)if(t.Childs()[i].IsOpen)e.push(t.Childs()[i].m_polygon);return e};o.Clipper.ClosedPathsFromPolyTree=function(t){var e=new o.Paths;o.Clipper.AddPolyNodeToPaths(t,o.Clipper.NodeType.ntClosed,e);return e};Ce(o.Clipper,o.ClipperBase);o.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2};o.ClipperOffset=function(t,e){if(typeof t=="undefined")t=2;if(typeof e=="undefined")e=o.ClipperOffset.def_arc_tolerance;this.m_destPolys=new o.Paths;this.m_srcPoly=new o.Path;this.m_destPoly=new o.Path;this.m_normals=new Array;this.m_delta=0;this.m_sinA=0;this.m_sin=0;this.m_cos=0;this.m_miterLim=0;this.m_StepsPerRad=0;this.m_lowest=new o.IntPoint;this.m_polyNodes=new o.PolyNode;this.MiterLimit=t;this.ArcTolerance=e;this.m_lowest.X=-1};o.ClipperOffset.two_pi=6.28318530717959;o.ClipperOffset.def_arc_tolerance=.25;o.ClipperOffset.prototype.Clear=function(){o.Clear(this.m_polyNodes.Childs());this.m_lowest.X=-1};o.ClipperOffset.Round=o.Clipper.Round;o.ClipperOffset.prototype.AddPath=function(t,e,i){var r=t.length-1;if(r<0)return;var n=new o.PolyNode;n.m_jointype=e;n.m_endtype=i;if(i==o.EndType.etClosedLine||i==o.EndType.etClosedPolygon)while(r>0&&o.IntPoint.op_Equality(t[0],t[r]))r--;n.m_polygon.push(t[0]);var s=0,l=0;for(var a=1;a<=r;a++)if(o.IntPoint.op_Inequality(n.m_polygon[s],t[a])){s++;n.m_polygon.push(t[a]);if(t[a].Y>n.m_polygon[l].Y||t[a].Y==n.m_polygon[l].Y&&t[a].X<n.m_polygon[l].X)l=s}if(i==o.EndType.etClosedPolygon&&s<2||i!=o.EndType.etClosedPolygon&&s<0)return;this.m_polyNodes.AddChild(n);if(i!=o.EndType.etClosedPolygon)return;if(this.m_lowest.X<0)this.m_lowest=new o.IntPoint(0,l);else{var h=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];if(n.m_polygon[l].Y>h.Y||n.m_polygon[l].Y==h.Y&&n.m_polygon[l].X<h.X)this.m_lowest=new o.IntPoint(this.m_polyNodes.ChildCount()-1,l)}};o.ClipperOffset.prototype.AddPaths=function(t,e,i){for(var r=0,n=t.length;r<n;r++)this.AddPath(t[r],e,i)};o.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!o.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon)){for(var t=0;t<this.m_polyNodes.ChildCount();t++){var e=this.m_polyNodes.Childs()[t];if(e.m_endtype==o.EndType.etClosedPolygon||e.m_endtype==o.EndType.etClosedLine&&o.Clipper.Orientation(e.m_polygon))e.m_polygon.reverse()}}else{for(var t=0;t<this.m_polyNodes.ChildCount();t++){var e=this.m_polyNodes.Childs()[t];if(e.m_endtype==o.EndType.etClosedLine&&!o.Clipper.Orientation(e.m_polygon))e.m_polygon.reverse()}}};o.ClipperOffset.GetUnitNormal=function(t,e){var i=e.X-t.X;var r=e.Y-t.Y;if(i==0&&r==0)return new o.DoublePoint(0,0);var n=1/Math.sqrt(i*i+r*r);i*=n;r*=n;return new o.DoublePoint(r,-i)};o.ClipperOffset.prototype.DoOffset=function(t){this.m_destPolys=new Array;this.m_delta=t;if(o.ClipperBase.near_zero(t)){for(var e=0;e<this.m_polyNodes.ChildCount();e++){var i=this.m_polyNodes.Childs()[e];if(i.m_endtype==o.EndType.etClosedPolygon)this.m_destPolys.push(i.m_polygon)}return}if(this.MiterLimit>2)this.m_miterLim=2/(this.MiterLimit*this.MiterLimit);else this.m_miterLim=.5;var r;if(this.ArcTolerance<=0)r=o.ClipperOffset.def_arc_tolerance;else if(this.ArcTolerance>Math.abs(t)*o.ClipperOffset.def_arc_tolerance)r=Math.abs(t)*o.ClipperOffset.def_arc_tolerance;else r=this.ArcTolerance;var n=3.14159265358979/Math.acos(1-r/Math.abs(t));this.m_sin=Math.sin(o.ClipperOffset.two_pi/n);this.m_cos=Math.cos(o.ClipperOffset.two_pi/n);this.m_StepsPerRad=n/o.ClipperOffset.two_pi;if(t<0)this.m_sin=-this.m_sin;for(var e=0;e<this.m_polyNodes.ChildCount();e++){var i=this.m_polyNodes.Childs()[e];this.m_srcPoly=i.m_polygon;var s=this.m_srcPoly.length
;if(s==0||t<=0&&(s<3||i.m_endtype!=o.EndType.etClosedPolygon))continue;this.m_destPoly=new Array;if(s==1){if(i.m_jointype==o.JoinType.jtRound){var l=1,a=0;for(var h=1;h<=n;h++){this.m_destPoly.push(new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[0].X+l*t),o.ClipperOffset.Round(this.m_srcPoly[0].Y+a*t)));var u=l;l=l*this.m_cos-this.m_sin*a;a=u*this.m_sin+a*this.m_cos}}else{var l=-1,a=-1;for(var h=0;h<4;++h){this.m_destPoly.push(new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[0].X+l*t),o.ClipperOffset.Round(this.m_srcPoly[0].Y+a*t)));if(l<0)l=1;else if(a<0)a=1;else l=-1}}this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var h=0;h<s-1;h++)this.m_normals.push(o.ClipperOffset.GetUnitNormal(this.m_srcPoly[h],this.m_srcPoly[h+1]));if(i.m_endtype==o.EndType.etClosedLine||i.m_endtype==o.EndType.etClosedPolygon)this.m_normals.push(o.ClipperOffset.GetUnitNormal(this.m_srcPoly[s-1],this.m_srcPoly[0]));else this.m_normals.push(new o.DoublePoint(this.m_normals[s-2]));if(i.m_endtype==o.EndType.etClosedPolygon){var p=s-1;for(var h=0;h<s;h++)p=this.OffsetPoint(h,p,i.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(i.m_endtype==o.EndType.etClosedLine){var p=s-1;for(var h=0;h<s;h++)p=this.OffsetPoint(h,p,i.m_jointype);this.m_destPolys.push(this.m_destPoly);this.m_destPoly=new Array;var f=this.m_normals[s-1];for(var h=s-1;h>0;h--)this.m_normals[h]=new o.DoublePoint(-this.m_normals[h-1].X,-this.m_normals[h-1].Y);this.m_normals[0]=new o.DoublePoint(-f.X,-f.Y);p=0;for(var h=s-1;h>=0;h--)p=this.OffsetPoint(h,p,i.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{var p=0;for(var h=1;h<s-1;++h)p=this.OffsetPoint(h,p,i.m_jointype);var d;if(i.m_endtype==o.EndType.etOpenButt){var h=s-1;d=new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[h].X+this.m_normals[h].X*t),o.ClipperOffset.Round(this.m_srcPoly[h].Y+this.m_normals[h].Y*t));this.m_destPoly.push(d);d=new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[h].X-this.m_normals[h].X*t),o.ClipperOffset.Round(this.m_srcPoly[h].Y-this.m_normals[h].Y*t));this.m_destPoly.push(d)}else{var h=s-1;p=s-2;this.m_sinA=0;this.m_normals[h]=new o.DoublePoint(-this.m_normals[h].X,-this.m_normals[h].Y);if(i.m_endtype==o.EndType.etOpenSquare)this.DoSquare(h,p);else this.DoRound(h,p)}for(var h=s-1;h>0;h--)this.m_normals[h]=new o.DoublePoint(-this.m_normals[h-1].X,-this.m_normals[h-1].Y);this.m_normals[0]=new o.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y);p=s-1;for(var h=p-1;h>0;--h)p=this.OffsetPoint(h,p,i.m_jointype);if(i.m_endtype==o.EndType.etOpenButt){d=new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*t),o.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*t));this.m_destPoly.push(d);d=new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*t),o.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*t));this.m_destPoly.push(d)}else{p=1;this.m_sinA=0;if(i.m_endtype==o.EndType.etOpenSquare)this.DoSquare(0,1);else this.DoRound(0,1)}this.m_destPolys.push(this.m_destPoly)}}};o.ClipperOffset.prototype.Execute=function(){var t=arguments,e=t[0]instanceof o.PolyTree;if(!e){var i=t[0],r=t[1];o.Clear(i);this.FixOrientations();this.DoOffset(r);var n=new o.Clipper(0);n.AddPaths(this.m_destPolys,o.PolyType.ptSubject,true);if(r>0){n.Execute(o.ClipType.ctUnion,i,o.PolyFillType.pftPositive,o.PolyFillType.pftPositive)}else{var s=o.Clipper.GetBounds(this.m_destPolys);var l=new o.Path;l.push(new o.IntPoint(s.left-10,s.bottom+10));l.push(new o.IntPoint(s.right+10,s.bottom+10));l.push(new o.IntPoint(s.right+10,s.top-10));l.push(new o.IntPoint(s.left-10,s.top-10));n.AddPath(l,o.PolyType.ptSubject,true);n.ReverseSolution=true;n.Execute(o.ClipType.ctUnion,i,o.PolyFillType.pftNegative,o.PolyFillType.pftNegative);if(i.length>0)i.splice(0,1)}}else{var i=t[0],r=t[1];i.Clear();this.FixOrientations();this.DoOffset(r);var n=new o.Clipper(0);n.AddPaths(this.m_destPolys,o.PolyType.ptSubject,true);if(r>0){n.Execute(o.ClipType.ctUnion,i,o.PolyFillType.pftPositive,o.PolyFillType.pftPositive)}else{var s=o.Clipper.GetBounds(this.m_destPolys);var l=new o.Path;l.push(new o.IntPoint(s.left-10,s.bottom+10));l.push(new o.IntPoint(s.right+10,s.bottom+10));l.push(new o.IntPoint(s.right+10,s.top-10));l.push(new o.IntPoint(s.left-10,s.top-10));n.AddPath(l,o.PolyType.ptSubject,true);n.ReverseSolution=true;n.Execute(o.ClipType.ctUnion,i,o.PolyFillType.pftNegative,o.PolyFillType.pftNegative);if(i.ChildCount()==1&&i.Childs()[0].ChildCount()>0){var a=i.Childs()[0];i.Childs()[0]=a.Childs()[0];for(var h=1;h<a.ChildCount();h++)i.AddChild(a.Childs()[h])}else i.Clear()}}};o.ClipperOffset.prototype.OffsetPoint=function(t,e,i){this.m_sinA=this.m_normals[e].X*this.m_normals[t].Y-this.m_normals[t].X*this.m_normals[e].Y;if(this.m_sinA<5e-5&&this.m_sinA>-5e-5)return e;else if(this.m_sinA>1)this.m_sinA=1;else if(this.m_sinA<-1)this.m_sinA=-1;if(this.m_sinA*this.m_delta<0){this.m_destPoly.push(new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[e].X*this.m_delta),o.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[e].Y*this.m_delta)));this.m_destPoly.push(new o.IntPoint(this.m_srcPoly[t]));this.m_destPoly.push(new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),o.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)))}else switch(i){case o.JoinType.jtMiter:{var r=1+(this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y);if(r>=this.m_miterLim)this.DoMiter(t,e,r);else this.DoSquare(t,e);break}case o.JoinType.jtSquare:this.DoSquare(t,e);break;case o.JoinType.jtRound:this.DoRound(t,e);break}e=t;return e};o.ClipperOffset.prototype.DoSquare=function(t,e){var i=Math.tan(Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y)/4);this.m_destPoly.push(new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[e].X-this.m_normals[e].Y*i)),o.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[e].Y+this.m_normals[e].X*i))));this.m_destPoly.push(new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[t].X+this.m_normals[t].Y*i)),o.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[t].Y-this.m_normals[t].X*i))))};o.ClipperOffset.prototype.DoMiter=function(t,e,i){var r=this.m_delta/i;this.m_destPoly.push(new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[t].X+(this.m_normals[e].X+this.m_normals[t].X)*r),o.ClipperOffset.Round(this.m_srcPoly[t].Y+(this.m_normals[e].Y+this.m_normals[t].Y)*r)))};o.ClipperOffset.prototype.DoRound=function(t,e){var i=Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y);var r=o.Cast_Int32(o.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(i)));var n=this.m_normals[e].X,s=this.m_normals[e].Y,l;for(var a=0;a<r;++a){this.m_destPoly.push(new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[t].X+n*this.m_delta),o.ClipperOffset.Round(this.m_srcPoly[t].Y+s*this.m_delta)));l=n;n=n*this.m_cos-this.m_sin*s;s=l*this.m_sin+s*this.m_cos}this.m_destPoly.push(new o.IntPoint(o.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),o.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)))};o.Error=function(t){try{throw new Error(t)}catch(t){console.log(t)}};o.JS={};o.JS.AreaOfPolygon=function(t,e){if(!e)e=1;return o.Clipper.Area(t)/(e*e)};o.JS.AreaOfPolygons=function(t,e){if(!e)e=1;var i=0;for(var r=0;r<t.length;r++){i+=o.Clipper.Area(t[r])}return i/(e*e)};o.JS.BoundsOfPath=function(t,e){return o.JS.BoundsOfPaths([t],e)};o.JS.BoundsOfPaths=function(t,e){if(!e)e=1;var i=o.Clipper.GetBounds(t);i.left/=e;i.bottom/=e;i.right/=e;i.top/=e;return i};o.JS.Clean=function(t,e){if(!(t instanceof Array))return[];var i=t[0]instanceof Array;var t=o.JS.Clone(t);if(typeof e!="number"||e===null){o.Error("Delta is not a number in Clean().");return t}if(t.length===0||t.length==1&&t[0].length===0||e<0)return t;if(!i)t=[t];var r=t.length;var n,s,l,a,h,u,p;var f=[];for(var d=0;d<r;d++){s=t[d];n=s.length;if(n===0)continue;else if(n<3){l=s;f.push(l);continue}l=s;a=e*e;h=s[0];u=1;for(p=1;p<n;p++){if((s[p].X-h.X)*(s[p].X-h.X)+(s[p].Y-h.Y)*(s[p].Y-h.Y)<=a)continue;l[u]=s[p];h=s[p];u++}h=s[u-1];if((s[0].X-h.X)*(s[0].X-h.X)+(s[0].Y-h.Y)*(s[0].Y-h.Y)<=a)u--;if(u<n)l.splice(u,n-u);if(l.length)f.push(l)}if(!i&&f.length)f=f[0];else if(!i&&f.length===0)f=[];else if(i&&f.length===0)f=[[]];return f};o.JS.Clone=function(t){if(!(t instanceof Array))return[];if(t.length===0)return[];else if(t.length==1&&t[0].length===0)return[[]];var e=t[0]instanceof Array;if(!e)t=[t];var i=t.length,r,n,s,o;var l=new Array(i);for(n=0;n<i;n++){r=t[n].length;o=new Array(r);for(s=0;s<r;s++){o[s]={X:t[n][s].X,Y:t[n][s].Y}}l[n]=o}if(!e)l=l[0];return l};o.JS.Lighten=function(t,e){if(!(t instanceof Array))return[];if(typeof e!="number"||e===null){o.Error("Tolerance is not a number in Lighten().");return o.JS.Clone(t)}if(t.length===0||t.length==1&&t[0].length===0||e<0){return o.JS.Clone(t)}if(!(t[0]instanceof Array))t=[t];var i,r,n,s,l,a,h,u,p,f,d,v;var c,P,m,y,g;var C=t.length;var x=e*e;var _=[];for(i=0;i<C;i++){n=t[i];a=n.length;if(a==0)continue;for(s=0;s<1e6;s++){l=[];a=n.length;if(n[a-1].X!=n[0].X||n[a-1].Y!=n[0].Y){v=1;n.push({X:n[0].X,Y:n[0].Y});a=n.length}else v=0;d=[];for(r=0;r<a-2;r++){h=n[r];p=n[r+1];u=n[r+2];y=h.X;g=h.Y;c=u.X-y;P=u.Y-g;if(c!==0||P!==0){m=((p.X-y)*c+(p.Y-g)*P)/(c*c+P*P);if(m>1){y=u.X;g=u.Y}else if(m>0){y+=c*m;g+=P*m}}c=p.X-y;P=p.Y-g;f=c*c+P*P;if(f<=x){d[r+1]=1;r++}}l.push({X:n[0].X,Y:n[0].Y});for(r=1;r<a-1;r++)if(!d[r])l.push({X:n[r].X,Y:n[r].Y});l.push({X:n[a-1].X,Y:n[a-1].Y});if(v)n.pop();if(!d.length)break;else n=l}a=l.length;if(l[a-1].X==l[0].X&&l[a-1].Y==l[0].Y){l.pop()}if(l.length>2)_.push(l)}if(!t[0]instanceof Array)_=_[0];if(typeof _=="undefined")_=[[]];return _};o.JS.PerimeterOfPath=function(t,e,i){if(typeof t=="undefined")return 0;var r=Math.sqrt;var n=0;var s,o,l=0,a=0,h=0,u=0;var p=t.length;if(p<2)return 0;if(e){t[p]=t[0];p++}while(--p){s=t[p];l=s.X;a=s.Y;o=t[p-1];h=o.X;u=o.Y;n+=r((l-h)*(l-h)+(a-u)*(a-u))}if(e)t.pop();return n/i};o.JS.PerimeterOfPaths=function(t,e,i){if(!i)i=1;var r=0;for(var n=0;n<t.length;n++){r+=o.JS.PerimeterOfPath(t[n],e,i)}return r};o.JS.ScaleDownPath=function(t,e){var i,r;if(!e)e=1;i=t.length;while(i--){r=t[i];r.X=r.X/e;r.Y=r.Y/e}};o.JS.ScaleDownPaths=function(t,e){var i,r,n,s=Math.round;if(!e)e=1;i=t.length;while(i--){r=t[i].length;while(r--){n=t[i][r];n.X=n.X/e;n.Y=n.Y/e}}};o.JS.ScaleUpPath=function(t,e){var i,r,n=Math.round;if(!e)e=1;i=t.length;while(i--){r=t[i];r.X=n(r.X*e);r.Y=n(r.Y*e)}};o.JS.ScaleUpPaths=function(t,e){var i,r,n,s=Math.round;if(!e)e=1;i=t.length;while(i--){r=t[i].length;while(r--){n=t[i][r];n.X=s(n.X*e);n.Y=s(n.Y*e)}}};o.ExPolygons=function(){return[]};o.ExPolygon=function(){this.outer=null;this.holes=null};o.JS.AddOuterPolyNodeToExPolygons=function(t,e){var i=new o.ExPolygon;i.outer=t.Contour();var r=t.Childs();var n=r.length;i.holes=new Array(n);var s,l,a,h,u,p;for(a=0;a<n;a++){s=r[a];i.holes[a]=s.Contour();for(h=0,u=s.Childs(),p=u.length;h<p;h++){l=u[h];o.JS.AddOuterPolyNodeToExPolygons(l,e)}}e.push(i)};o.JS.ExPolygonsToPaths=function(t){var e,i,r,n;var s=new o.Paths;for(e=0,r=t.length;e<r;e++){s.push(t[e].outer);for(i=0,n=t[e].holes.length;i<n;i++){s.push(t[e].holes[i])}}return s};o.JS.PolyTreeToExPolygons=function(t){var e=new o.ExPolygons;var i,r,n,s;for(r=0,n=t.Childs(),s=n.length;r<s;r++){i=n[r];o.JS.AddOuterPolyNodeToExPolygons(i,e)}return e}})(this);i("ThirdParty/clipper-js/lib/index",["../../clipper-lib/clipper"],function(t){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:true});var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(t,r.key,r)}}return function(e,i,r){if(i)t(e.prototype,i);if(r)t(e,r);return e}}();var r=n(t);function n(t){return t&&t.__esModule?t:{default:t}}function s(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++){i[e]=t[e]}return i}else{return Array.from(t)}}function o(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}var l=new r.default.Clipper;var a=new r.default.ClipperOffset;var h=function(){function t(){var e=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];var i=arguments.length<=1||arguments[1]===undefined?true:arguments[1];var r=arguments.length<=2||arguments[2]===undefined?false:arguments[2];o(this,t);this.paths=r?e.map(p):e;this.closed=i}i(t,[{key:"_clip",value:function e(i,n){var s=new r.default.PolyTree;l.Clear();l.AddPaths(this.paths,r.default.PolyType.ptSubject,this.closed);l.AddPaths(i.paths,r.default.PolyType.ptClip,i.closed);l.Execute(n,s);var o=undefined;if(this.closed){o=r.default.Clipper.ClosedPathsFromPolyTree(s)}else{o=r.default.Clipper.OpenPathsFromPolyTree(s)}return new t(o,this.closed)}},{key:"union",value:function t(e){return this._clip(e,r.default.ClipType.ctUnion)}},{key:"difference",value:function t(e){return this._clip(e,r.default.ClipType.ctDifference)}},{key:"intersect",value:function t(e){return this._clip(e,r.default.ClipType.ctIntersection)}},{key:"xor",value:function t(e){return this._clip(e,r.default.ClipType.ctXor)}},{key:"offset",value:function e(i,n){var s=n.jointType;var o=s===undefined?"jtSquare":s;var l=n.endType;var h=l===undefined?"etClosedPolygon":l;var u=n.miterLimit;var p=u===undefined?2:u;var f=n.roundPrecision;var d=f===undefined?.25:f;a.Clear();a.ArcTolerance=d;a.MiterLimit=p;var v=new r.default.Paths;a.AddPaths(this.paths,r.default.JoinType[o],r.default.EndType[h]);a.Execute(v,i);return new t(v,true)}},{key:"scaleUp",value:function t(e){r.default.JS.ScaleUpPaths(this.paths,e);return this}},{key:"scaleDown",value:function t(e){r.default.JS.ScaleDownPaths(this.paths,e);return this}},{key:"lastPoint",value:function t(){if(this.paths.length===0){return}var e=this.paths[this.paths.length-1];return this.closed?e[0]:e[e.length-1]}},{key:"areas",value:function t(){var t=[];for(var e=0;e<this.paths.length;e++){var i=this.area(e);t.push(i)}return t}},{key:"area",value:function t(e){var i=this.paths[e];var t=r.default.Clipper.Area(i);return t}},{key:"totalArea",value:function t(){return this.areas().reduce(function(t,e){return t+e})}},{key:"reverse",value:function t(){r.default.Clipper.ReversePaths(this.paths);return this}},{key:"tresholdArea",value:function t(e){var i=[].concat(s(this.paths));for(var n=0;n<i.length;n++){var o=i[n];var l=Math.abs(r.default.Clipper.Area(shape));if(l<e){var a=this.paths.indexOf(o);this.splice(a,1)}}}},{key:"join",value:function t(e){this.paths.join(e.paths);return this}},{key:"clone",value:function e(){return new t(r.default.JS.Clone(this.paths),this.closed)}},{key:"shapeBounds",value:function t(){var e=r.default.JS.BoundsOfPaths(this.paths);e.width=e.right-e.left;e.height=e.bottom-e.top;e.size=e.width*e.height;return e}},{key:"pathBounds",value:function t(e){var i=this.paths[e];var n=r.default.JS.BoundsOfPath(i);n.width=n.right-n.left;n.height=n.bottom-n.top;n.size=n.width*n.height;return n}},{key:"clean",value:function e(i){return new t(r.default.Clipper.CleanPolygons(this.paths,i),this.closed)}},{key:"orientation",value:function t(e){var i=this.paths[e];return r.default.Clipper.Orientation(i)}},{key:"pointInShape",value:function t(e){for(var i=0;i<this.paths.length;i++){var r=this.pointInPath(i,e);var n=this.orientation(i);if(!r&&n||r&&!n){return false}}return true}},{key:"pointInPath",value:function t(e,i){var n=this.paths[e];var s={X:Math.round(i.X),Y:Math.round(i.Y)};return r.default.Clipper.PointInPolygon(s,n)>0}},{key:"fixOrientation",value:function t(){if(!this.closed){return this}if(this.totalArea()<0){this.reverse()}}},{key:"removeOverlap",value:function e(){if(this.closed){var i=r.default.Clipper.SimplifyPolygons(this.paths,r.default.PolyFillType.pftNonZero);return new t(i,true)}else{return this}}},{key:"seperateShapes",value:function e(){var i=this;var r=[];if(!this.closed){var n=true;var s=false;var o=undefined;try{for(var l=this.paths[Symbol.iterator](),a;!(n=(a=l.next()).done);n=true){var h=a.value;r.push(new t([h],false))}}catch(t){s=true;o=t}finally{try{if(!n&&l.return){l.return()}}finally{if(s){throw o}}}}else{(function(){var e=new WeakMap;var n=[];var s=[];for(var o=0;o<i.paths.length;o++){var l=i.paths[o];var a=i.orientation(o);if(a){var h=i.area(o);e.set(l,{area:h,index:o});n.push(l)}else{s.push(l)}}n.sort(function(t,i){return e.get(t).area>e.get(i).area});var u=true;var p=false;var f=undefined;try{for(var d=n[Symbol.iterator](),v;!(u=(v=d.next()).done);u=true){var c=v.value;var P=[c];var m=e.get(c);var y=m.index;var g=[].concat(s);for(var C=0;C<g.length;C++){var x=g[C];var _=i.pointInPath(y,x[0]);if(_){P.push(x);var I=s.indexOf(x);s.splice(I,1)}}r.push(new t(P,true))}}catch(t){p=true;f=t}finally{try{if(!u&&d.return){d.return()}}finally{if(p){throw f}}}})()}return r}},{key:"mapToLower",value:function t(){return this.paths.map(u)}}]);return t}();e.default=h;function u(t){return t.map(function(t){var e=t.X;var i=t.Y;return{x:e,y:i}})}function p(t){return t.map(function(t){var e=t.x;var i=t.y;return{X:e,Y:i}})}return e["default"]});function r(t,e){var i=[];var r,n;var s=e.slice();for(var o=0,l=t.length;o<l;o+=2){r=t.charCodeAt(o)-64;n=t.charCodeAt(o+1)-64;r=(r>>1^-(r&1))+s[0];n=(n>>1^-(n&1))+s[1];s[0]=r;s[1]=n;i.push([r/1024,n/1024])}return i}function n(t){var e={MultiPolygon:function(t,e){return t.map(function(t,i){return r(t,e[i])})},Polygon:r};var i=[];if(typeof t==="string"){t=JSON.parse(t)}i=t.features;if(!t.UTF8Encoding){return t}for(var n=0,s=i.length;n<s;n++){var o=i[n].geometry;var l=o.coordinates;var a=o.encodeOffsets;l.forEach(function(t,i){l[i]=e[o.type](t,a[i])})}t.UTF8Encoding=false;return t}function s(t,e,i){this.name=t;this.contours=e;if(!i){var r=this.getBoundingRect();i=[(r.xMin+r.xMax)/2,(r.yMin+r.yMax)/2]}this.center=i}s.prototype.getBoundingRect=function(){var t=Number.MAX_VALUE;var e=function(e){var i=[t,t],r=[-t,-t];e.forEach(function(t){i[0]=Math.min(i[0],t[0]);r[0]=Math.max(r[0],t[0]);i[1]=Math.min(i[1],t[1]);r[1]=Math.max(r[1],t[1])});return{xMin:i[0],yMin:i[1],xMax:r[0],yMax:r[1]}};var i={xMin:t,yMin:t,xMax:-t,yMax:-t};this.contours.forEach(function(t){t.forEach(function(t){var r=e(t);i.xMin=Math.min(i.xMin,r.xMin);i.xMax=Math.max(i.xMax,r.xMax);i.yMin=Math.min(i.yMin,r.yMin);i.yMax=Math.max(i.yMax,r.yMax)})});return i};var o=function(t){var e=n(t);var i=e.features.filter(function(t){return t.properties&&t.geometry&&t.geometry.coordinates.length>0});return i.map(function(t){var e=t.geometry;var i=e.coordinates;if(e.type==="Polygon"){i=i.map(function(t){return[t]})}return new s(t.properties.name,i,t.properties.cp)})};o.Region=s;o.decodeCoordinate=r;o.decodeGeoJSON=n;if(typeof module==="undefined"){this.geoJSONParser=o}else{module.exports=o}if(typeof i==="function"){i("Data/Geojson/geoJSONParser",[],function(){return o})}function l(t,e){var i={width:t,height:e};function r(t){var e=Number.MAX_VALUE;var i,r;var n={xMin:e,yMin:e,xMax:-e,yMax:-e};for(var s=0,o=t.length;s<o;s++){var l=t[s].getBoundingRect();i={x:l.xMin,y:l.yMin};r={x:l.xMax,y:l.yMax};n.xMin=n.xMin<i.x?n.xMin:i.x;n.yMin=n.yMin<i.y?n.yMin:i.y;n.xMax=n.xMax>r.x?n.xMax:r.x;n.yMax=n.yMax>r.y?n.yMax:r.y}return n}function n(t,e){var r=e.xMax-e.xMin;var n=e.yMin-e.yMax;var s=Math.abs(t[0]-e.xMin);var o=t[1]-e.yMax;var l=s/r*i.width,a=o/n*i.height;return{x:l,y:a}}function s(t,e){var r=e.xMax-e.xMin;var n=e.yMin-e.yMax;var s=t.x/i.width*r,o=t.y/i.height*n;return[s,o]}this.project=n;this.unproject=s;this.getBoundingRect=r}if(typeof module==="undefined"){this.LonLatProjection=l}else{module.exports=l}if(typeof i==="function"){i("Data/Geojson/LonLatProjection",[],function(){return l})}i("Util/CanvasWorker/CanvasRenderingContext2D",["Util/defined","Util/defineProperties","./ImageData","./Error","./Color","./CanvasPattern","ThirdParty/clipper-js/lib/index","Data/Geojson/geoJSONParser","Data/Geojson/LonLatProjection"],function(t,e,i,r,n,s,o,l,a){var h=new n;var u=new n;var p=new r("CanvasRenderingContext2D");var f={butt:"etOpenButt",round:"etOpenRound",square:"etOpenSquare"};var d={bevel:"jtSquare",round:"jtRound",miter:"jtMiter"};var v=["butt","round","square"];var c=["bevel","round","miter"];var P=["repeat","no-repeat","repeat-x","repeat-y"];var m=["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","copy","xor"];function y(t){this.canvas=t;this._fillStyle=new n("#000000");this._globalAlpha=1;this._globalCompositeOperation="source-over";this._lineCap="butt";this._lineJoin="miter";this._lineWidth=2;this._miterLimit=10;this._strokeStyle=new n("#000000");this._paths=[{closed:false,path:[]}];this._transform=[1,0,0,1,0,0];this._transformStack=[]}e(y.prototype,{fillStyle:{set:function(t){if(typeof t==="string"){t=new n(t)}this._fillStyle=t},get:function(){if(this._fillStyle instanceof n){return this._fillStyle.str}else{return this._fillStyle}}},strokeStyle:{set:function(t){if(typeof t==="string"){t=new n(t)}this._strokeStyle=t},get:function(){if(this._strokeStyle instanceof n){return this._strokeStyle.str}else{return this._strokeStyle}}},lineJoin:{set:function(t){this._lineJoin=c.indexOf(t)!==-1?t:this._lineJoin},get:function(){return this._lineJoin}},lineCap:{set:function(t){this._lineCap=v.indexOf(t)!==-1?t:this._lineCap},get:function(){return this._lineCap}},globalAlpha:{set:function(t){this._globalAlpha=t>=0&&t<=1?t:this._globalAlpha},get:function(){return this._globalAlpha}},globalCompositeOperation:{set:function(t){this._globalCompositeOperation=m.indexOf(t)!==-1?t:this._globalCompositeOperation},get:function(){return this._globalCompositeOperation}},lineWidth:{set:function(t){this._lineWidth=t>0?t:this._lineWidth},get:function(){return this._lineWidth}},miterLimit:{set:function(t){this._miterLimit=t>0?t:this._miterLimit},get:function(){return this._miterLimit}}});y.prototype.beginPath=function(){this._paths.splice(0,this._paths.length,[{closed:false,path:[]}])};y.prototype.lineTo=function(t,e){p.argumetsCheck("lineTo",2,arguments.length);this._paths[0].path.push({x:t,y:e})};y.prototype.moveTo=function t(e,i){p.argumetsCheck("moveTo",2,arguments.length);this._paths.unshift({closed:false,path:[{x:e,y:i}]})};y.prototype.arc=function t(e,i,r,n,s,o){var l=[];var a=s-n;var h=a/Math.PI*90;var u=a/h;u=o?-u:u;var p=r*Math.cos(n)+e,f=r*Math.sin(n)+i;this.moveTo(p,f);for(var d=n;d<s;d+=u){p=r*Math.cos(n+d)+e,f=r*Math.sin(n+d)+i;this.lineTo(p,f)}this.lineTo(r*Math.cos(s)+e,r*Math.sin(s)+i);this.lineTo(r*Math.cos(n)+e,r*Math.sin(n)+i)};y.prototype.fillText=function t(e,i,r,n){};y.prototype.drawGeojson=function(t,e,i,r,n,s,o,h){if(typeof o=="undefined"){o=true}if(typeof h=="undefined"){h=true}if(!o&&!h){return}if(typeof n=="undefined"){n=this.canvas.width-t}if(typeof s=="undefined"){s=this.canvas.height-e}var u=l(i);if(r){var p=[];for(var f=0,d=u.length;f<d;f++){if(r(u[f])){p.push(u[f])}}u=p}var v=new a(n,s);var c=v.getBoundingRect(u);var P=this;for(var f=0,d=u.length;f<d;f++){var m=u[f].contours;for(var y=0,g=m.length;y<g;y++){for(var C=0,x=m[y].length;C<x;C++){var _=0;P.beginPath();m[y][C].map(function(i){var r=v.project(i,c);if(_==0){P.moveTo(t+r.x,e+r.y)}else{P.lineTo(t+r.x,e+r.y)}_++});if(h){this.stroke()}if(o){this.fill()}}}}u=[];v=null};y.prototype.closePath=function(){this._paths[0].closed=true;this._paths.unshift({closed:false,path:[]})};y.prototype.rect=function(t,e,i,r){var n=t+i;var s=e+r;this.moveTo(t,e);this.lineTo(n,e);this.lineTo(n,s);this.lineTo(t,s);this.closePath()};y.prototype.stroke=function(){var t=this._getInverseTransfrom();var e=this.lineWidth/2;var i=d[this.lineJoin];var r=this.miterLimit;var n=this._paths.filter(function(t){return t.path&&t.path.length>0});var s=new o;for(var l=0;l<n.length;l++){var a=n[l];var h=a.path,p=a.closed;var v=p?"etClosedLine":f[this.lineCap];var c=new o([h],false,true);c=c.offset(e,{jointType:i,endType:v,miterLimit:r});s.paths=s.paths.concat(c.paths)}s=s.removeOverlap();for(var P=0;P<this.canvas.height;P++){for(var m=0;m<this.canvas.width;m++){var y=this._destinationToSource(m,P,t);var g={X:y.sourceX,Y:y.sourceY};if(s.paths.length>0&&s.pointInShape(g)){this._drawPixel(m,P,this._strokeStyle.getPixel(m,P))}else{this._drawPixel(m,P,u)}}}};y.prototype.fill=function(){var t=this._getInverseTransfrom();var e=this._paths.map(function(t){return t.path}).filter(function(t){return t&&t.length>0});var i=new o(e,true,true);for(var r=0;r<this.canvas.height;r++){for(var n=0;n<this.canvas.width;n++){var s=this._destinationToSource(n,r,t);var l={X:s.sourceX,Y:s.sourceY};if(i.pointInShape(l)){this._drawPixel(n,r,this._fillStyle.getPixel(n,r))}else{this._drawPixel(n,r,u)}}}};y.prototype.fillRect=function(t,e,i,r){var n=t+i;var s=e+r;var o=this._getInverseTransfrom();for(var l=0;l<this.canvas.height;l++){for(var a=0;a<this.canvas.width;a++){var h=this._destinationToSource(a,l,o);var p=h.sourceX,f=h.sourceY;if(p>=t&&f>=e&&p<n&&f<s){this._drawPixel(a,l,this._fillStyle.getPixel(a,l))}else{this._drawPixel(a,l,u)}}}};y.prototype.strokeRect=function(t,e,i,r){};y.prototype.translate=function(t,e){p.argumetsCheck("translate",2,arguments.length);this._transform[4]+=t;this._transform[5]+=e};y.prototype.transform=function(){p.argumetsCheck("transform",6,arguments.length);var t=arguments;var e=this._transform;this._transform.splice(0,6,e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[4]*t[0]+e[5]*t[1]+t[4],e[4]*t[2]+e[5]*t[3]+t[5])};y.prototype.rotate=function(t){p.argumetsCheck("rotate",1,arguments.length);var e=Math.sin(t);var i=Math.cos(t);this.transform(i,-e,e,i,0,0)};y.prototype.scale=function(t,e){p.argumetsCheck("scale",2,arguments.length);this._transform[0]*=t;this._transform[3]*=e};y.prototype.save=function(){var t=[].concat(this._transform);this._transformStack.push([])};y.prototype.restore=function(){var t=this._transformStack.pop();if(t){this._transform.splice(0,6,t[0],t[1],t[2],t[3],t[4],t[5])}else{this._transform.splice(0,6,1,0,0,1,0,0)}};y.prototype.drawImage=function(t,e,i,r,n,s,o,l,a){p.argumetsCheck("drawImage",3,arguments.length);if(arguments.length>=9){var h=arguments[0],f=arguments[1],d=arguments[2],v=arguments[3],c=arguments[4],P=arguments[5],m=arguments[6],y=arguments[7],g=arguments[8]}else if(arguments.length>=5){var h=arguments[0],P=arguments[1],m=arguments[2],y=arguments[3],g=arguments[4];var f=0;var d=0;var v=h.width;var c=h.height}else if(arguments.length>=3){var h=arguments[0],P=arguments[1],m=arguments[2];var y=h.width;var g=h.height;var f=0;var d=0;var v=h.width;var c=h.height}var C=this._getInverseTransfrom();var x=v/y;var _=c/g;var I=f;var E=d;var T=v+f;var L=c+d;for(var X=0;X<this.canvas.height;X++){for(var w=0;w<this.canvas.width;w++){var O=this._destinationToSource(w,X,C);var Y=O.sourceX,S=O.sourceY;var s=Math.round((Y-P)*x+f);var o=Math.round((S-m)*_+d);if(s>=I&&o>=E&&s<T&&o<L){var N=o*h.width+s;var A=h.imageData.r[N];var D=h.imageData.g[N];var b=h.imageData.b[N];var B=h.imageData.a[N];this._drawPixel(w,X,{r:A,g:D,b:b,a:B})}else{this._drawPixel(w,X,u)}}}};y.prototype.clearRect=function(t,e,i,r){p.argumetsCheck("clearRect",4,arguments.length);var n=t+i;var s=e+r;var o=this.canvas.imageData;for(var l=e;l<s;l++){for(var a=t;a<n;a++){var h=l*this.canvas.width+a;o.r[h]=0;o.g[h]=0;o.b[h]=0;o.a[h]=0}}};y.prototype.getImageData=function(t,e,r,n){p.argumetsCheck("getImageData",4,arguments.length);var s=t+r;var o=e+n;var l=this.canvas.imageData;var a=new Uint8ClampedArray(r*n*4);var h=0;for(var u=e;u<o;u++){for(var f=t;f<s;f++){var d=u*this.canvas.width+f;a[h++]=l.r[d];a[h++]=l.g[d];a[h++]=l.b[d];a[h++]=Math.round(l.a[d]*255)}}return new i(r,n,a)};y.prototype.putImageData=function(t,e,i){var r=t[0],n=t[1],s=t[2];for(var o=0,l=0;o<s.length;o++){var a=o+e+i*this.canvas.width;this.canvas.imageData.r[a]=s[l++];this.canvas.imageData.g[a]=s[l++];this.canvas.imageData.b[a]=s[l++];this.canvas.imageData.a[a]=s[l++]/255}};y.prototype.createImageData=function(t,e){p.argumetsCheck("createImageData",2,arguments.length);return new i(t,e)};y.prototype.createPattern=function(t,e){if(P.indexOf(e)===-1){var i=P.map(function(t){return t}).reduce(function(t,e,i,r){if(i===r.length-1){return t?t:e}else{return t+","+e}});p.syntaxError("createPattern","The provided type ("+e+") is not one of "+i)}return new s(t,e)};y.prototype._drawPixel=function(t,e,i){var r=h.set(i.r,i.g,i.b,i.a);r.a*=this.globalAlpha;var n=e*this.canvas.width+t;var s=this.canvas.imageData.r[n];var o=this.canvas.imageData.g[n];var l=this.canvas.imageData.b[n];var a=this.canvas.imageData.a[n];var u;switch(this.globalCompositeOperation){case"copy":u=r.copy(s,o,l,a);break;case"source-over":u=r.sourceOver(s,o,l,a);break;case"destination-over":u=r.destinationOver(s,o,l,a);break;case"source-in":u=r.sourceIn(s,o,l,a);break;case"destination-in":u=r.destinationIn(s,o,l,a);break;case"source-out":u=r.sourceOut(s,o,l,a);break;case"destination-out":u=r.destinationOut(s,o,l,a);break;case"source-atop":u=r.sourceAtop(s,o,l,a);break;case"destination-atop":u=r.destinationAtop(s,o,l,a);break;case"xor":u=r.xOr(s,o,l,a);break;case"lighter":u=r.lighter(s,o,l,a);break}this.canvas.imageData.r[n]=u.r;this.canvas.imageData.g[n]=u.g;this.canvas.imageData.b[n]=u.b;this.canvas.imageData.a[n]=u.a};y.prototype._getInverseTransfrom=function(){var t=this._transform;var e=1/(t[0]*t[3]-t[1]*t[2]);return[e*t[3],-e*t[1],-e*t[2],e*t[0],e*(t[1]*t[5]-t[4]*t[3]),-e*(t[0]*t[5]-t[4]*t[2])]};y.prototype._destinationToSource=function(t,e,i){var r=i[0]*t+i[2]*e+i[4];var n=i[1]*t+i[3]*e+i[5];return{sourceX:r,sourceY:n}};return y});i("Util/CanvasWorker/CanvasImageSource",["Util/defineProperties","./Color"],function(t,e){function i(t,e){if(!t){t=0}if(!e){e=0}this._width=t;this._height=e;this._initImageData()}t(i.prototype,{width:{set:function(t){this._width=t;this._initImageData()},get:function(){return this._width}},height:{set:function(t){this._height=t;this._initImageData()},get:function(){return this._height}}});i.prototype._initImageData=function(){var t=this._width*this._height;this.imageData={r:new Uint8ClampedArray(t),g:new Uint8ClampedArray(t),b:new Uint8ClampedArray(t),a:new Float32Array(t)}};return i});i("Util/CanvasWorker/HTMLCanvasElement",["./CanvasRenderingContext2D","./CanvasImageSource"],function(t,e){function i(t,i){if(!t){t=300}if(!i){i=300}e.apply(this,[t,i])}i.prototype=new e;i.prototype.getContext=function(e){switch(e){case"2d":return new t(this);default:return null}};return i});i("Util/CanvasWorker/getPixels",[],function(){function t(t,e){if(!e){throw new Error("callback is required")}var i=new Image;i.src=t;i.onload=function(){var t=this.width;var i=this.height;var r=document.createElement("canvas");var n=r.getContext("2d");r.width=t;r.height=i;n.drawImage(this,0,0,t,i);var s=n.getImageData(0,0,t,i);e(undefined,{shape:[i,t],data:s.data});s=null};i.onerror=function(t){e(t)}}return t});i("Util/CanvasWorker/Image",["Util/defined","Util/defineProperties","./getPixels","./CanvasImageSource"],function(t,e,i,r){function n(){this._src=""}n.prototype=new r;e(n.prototype,{src:{set:function(t){this._src=t;i(t,function(t,e){if(t){return}var i=e.shape[1];var r=e.shape[0];this.width=i;this.height=r;var n=i*r;for(var s=0,o=0;o<n;o++){this.imageData.r[o]=e.data[s++];this.imageData.g[o]=e.data[s++];this.imageData.b[o]=e.data[s++];this.imageData.a[o]=e.data[s++]/255}if(this.onload!==undefined){this.onload()}})},get:function(){return this._src}}});return n});i("Util/CanvasWorker/transfer",["./HTMLCanvasElement","./ImageData","./Image"],function(t,e,i){var r,n;if(self.document!==undefined){r=document.createElement("canvas");n=r.getContext("2d")}var s=new t;var o=s.getContext("2d");var l={};l.decode=function(e,s){if(self.document!==undefined){switch(e){case"canvas":{var o=document.createElement("canvas");o.width=s.width
;o.height=s.height;var l=o.getContext("2d");var h=a(s);l.putImageData(h,0,0);return o}case"image":{r.width=s.width;r.height=s.height;var h=a(s);n.putImageData(h,0,0);var u=new Image;u.src=r.toDataURL();return u}case"imageData":{return a(s)}}}else{switch(e){case"canvas":{var o=new t(s.width,s.height);var p=s.width*s.height;for(var f=0,d=0;d<p;d++){o.imageData.r[d]=s.data[f++];o.imageData.g[d]=s.data[f++];o.imageData.b[d]=s.data[f++];o.imageData.a[d]=s.data[f++]/255}return o}case"image":{var u=new i;u.width=s.width;u.height=s.height;var p=s.width*s.height;for(var f=0,d=0;d<p;d++){u.imageData.r[d]=s.data[f++];u.imageData.g[d]=s.data[f++];u.imageData.b[d]=s.data[f++];u.imageData.a[d]=s.data[f++]/255}return u}case"imageData":{return new i(s.width,s.height,s.data)}}}};l.encode=function(l){var a,h;if(l instanceof t){var u=l.getContext("2d");var p=u.getImageData(0,0,l.width,l.height);h={data:p._data,height:p._height,width:p._width};a="canvas"}else if(l instanceof e){h={data:l._data,height:l._height,width:l._width};a="imageData"}else if(l instanceof i){s.width=l.width;s.height=l.height;o.drawImage(l,0,0);var p=o.getImageData(0,0,l.width,l.height);h={data:p._data,height:p._height,width:p.width};a="image"}else if(l instanceof HTMLCanvasElement){r.width=l.width;r.height=l.height;n.drawImage(l,0,0);h=n.getImageData(0,0,l.width,l.height);a="canvas"}else if(l instanceof ImageData){h=l;a="imageData"}else if(l instanceof Image){r.width=l.width;r.height=l.height;n.drawImage(l,0,0);h=n.getImageData(0,0,l.width,l.height);a="image"}return{data:{type:a,imageData:h},buffer:h.data.buffer}};function a(t){var e=t.width,i=t.height,r=t.data;var s=n.createImageData(e,i);for(var o=0;o<r.length;o++){s.data[o]=r[o]}return s}return l});i("Util/CanvasWorker/index",["./HTMLCanvasElement","./Image","./transfer"],function(t,e,i){var r={};r.Canvas=t;r.Image=e;r.transfer=i;return r});e(["Util/CanvasWorker/index"],function(t){self.CanvasWorker=t;if(window){window.CanvasWorker}});i("CanvasWorker",function(){});e(["Util/CanvasWorker/index"],function(t){"use strict";var e=typeof window!=="undefined"?window:typeof self!=="undefined"?self:{};e.CanvasWorker=t},undefined,true)})();if(typeof define==="function"){define(function(){return CanvasWorker})}else if(typeof module==="undefined"){window.CanvasWorker=CanvasWorker}else{module.exports=CanvasWorker}