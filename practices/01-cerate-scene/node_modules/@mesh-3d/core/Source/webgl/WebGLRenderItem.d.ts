
import MeshVisualizer from "../MeshVisualizer.js";

import * as THREE from '@mesh-3d/three';
import Cesium from '@mesh-3d/cesium';

/**
 * 渲染项目，封装一个绘图命令及其原始对象（Object3D）、几何体（geometry）、几何分组索引（groupIndex）、材质（material）、材质索引（materialIndex），
 * 提供一个渲染前更新的方法和一个销毁渲染相关资源的方法。
 */
export default class WebGLRenderItem {
    /**
     * 
     * @param {Cesium.DrawCommand} drawCommand 
     * @param {THREE.Material} material 
     * @param {number} materialIndex 
     * @param {THREE.Mesh|THREE.Line|THREE.Points|THREE.Sprite} object
     * @param {THREE.BufferGeometry} geometry 
     * @param {MeshVisualizer}visualizer
     * @param {number} [groupIndex]
     * @private
     */
    constructor(drawCommand: Cesium.DrawCommand, material: THREE.Material, materialIndex: number, object: THREE.Mesh | THREE.Line | THREE.Points | THREE.Sprite, geometry: THREE.BufferGeometry, visualizer: MeshVisualizer, groupIndex: number)

    id: number;
    drawCommand: Cesium.DrawCommand;

    material: THREE.Material;
    geometry: THREE.BufferGeometry;
    materialIndex: number;
    groupIndex: number
    object: THREE.Mesh | THREE.Line | THREE.Points | THREE.Sprite;
    groupOrder: number;
    renderOrder: number;

    visualizer: MeshVisualizer
    currentScene: THREE.Object3D | MeshVisualizer;
    currentCamera: THREE.PerspectiveCamera | THREE.OrthographicCamera

    //runtime state

    /**
     * local
     */
    boundingSphere: Cesium.BoundingSphere;//local
    /**
     * world
     */
    boundingVolume: Cesium.BoundingSphere;//world

    materialVersion: number
    renderVersion: number
    programCacheKey: string
    wireframeIndices: number[]
    frustumCulled: boolean
    z: number;
    distanceToCamera: number
    visible: undefined | boolean;
    loaded: boolean
    initialized: boolean;

    readonly pass: Cesium.Pass
    readonly renderPass: Cesium.Pass
    readonly modelMatrix: Cesium.Matrix4

    update(object: THREE.Mesh | THREE.Line | THREE.Points | THREE.Sprite, drawCommand: Cesium.DrawCommand, geometry: THREE.BufferGeometry, modelMatrixNeedsUpdate: boolean): void
    destroy()
}
